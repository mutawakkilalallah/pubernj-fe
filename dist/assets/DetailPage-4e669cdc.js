import{C as y,E as w,I as _,g as k,y as P,a as C,c as p,b as e,j as V,t as i,u as t,k as u,F as g,l as f,d as A,Q as v,v as M,o as c,n as x,T as N}from"./index-f4a023c3.js";const h=y("table_armada_detail",{state:()=>({user:localStorage.getItem("user")?w():null,armada:{},items:[],filter:{area:[],dropspot:[]},meta:{},params:{cari:"",armada:"n",area:"",dropspot:"",jenis_kelamin:"",limit:""}}),actions:{async getData(){const d={params:this.params};try{await _.get("penumpang",d).then(a=>{(a.data.code=200)&&(this.items=a.data.data,this.filter.area=a.data.filter.area,this.meta=a.headers)})}catch{}},async getDropspot(){this.params.dropspot="",this.getData();const d={params:{area:this.params.area}};try{await _.get("dropspot",d).then(a=>{(a.data.code=200)&&(this.filter.dropspot=a.data.data)})}catch{}},async getDataDetail(d){try{await _.get(`armada/${d}`).then(a=>{(a.data.code=200)&&(this.armada=a.data.data)})}catch{}}}}),T=y("form_armada_detail",{state:()=>({formAddArmada:{id_penumpang:[]},formDelArmada:{id_penumpang:[]},lastSelectedIndexAddArmada:null,lastSelectedIndexDelArmada:null}),actions:{handleRowClickAddArmada(d){const a=d;if(event.shiftKey&&this.lastSelectedIndexAddArmada!==null){const o=Math.min(d,this.lastSelectedIndexAddArmada),r=Math.max(d,this.lastSelectedIndexAddArmada);if(a===r)for(let n=o+1;n<=r;n++)this.addIdPenumpangAddArmada(n);else if(a===o)for(let n=o;n+1<=r;n++)this.addIdPenumpangAddArmada(n);else for(let n=o;n<=r;n++)this.addIdPenumpangAddArmada(n)}else this.addIdPenumpangAddArmada(d);this.lastSelectedIndexAddArmada=d},handleRowDelArmada(d){const a=d;if(event.shiftKey&&this.lastSelectedIndexDelArmada!==null){const o=Math.min(d,this.lastSelectedIndexDelArmada),r=Math.max(d,this.lastSelectedIndexDelArmada);if(a===r)for(let n=o+1;n<=r;n++)this.addIdPenumpangDelArmada(n);else if(a===o)for(let n=o;n+1<=r;n++)this.addIdPenumpangDelArmada(n);else for(let n=o;n<=r;n++)this.addIdPenumpangDelArmada(n)}else this.addIdPenumpangDelArmada(d);this.lastSelectedIndexDelArmada=d},addIdPenumpangAddArmada(d){const a=h(),o=this.formAddArmada.id_penumpang.indexOf(a.items[d].id);o===-1?this.formAddArmada.id_penumpang.push(a.items[d].id):this.formAddArmada.id_penumpang.splice(o,1)},addIdPenumpangDelArmada(d){const a=h(),o=this.formDelArmada.id_penumpang.indexOf(a.armada.penumpang[d].id);o===-1?this.formDelArmada.id_penumpang.push(a.armada.penumpang[d].id):this.formDelArmada.id_penumpang.splice(o,1)},dragStartAddArmada(d){const a=h();this.formAddArmada.id_penumpang.push(a.items[d].id)},allowDropAddArmada(d){d.preventDefault()},dropAddArmada(d,a){d.preventDefault(),this.hitAddArmada(this.formAddArmada,a),this.formAddArmada.id_penumpang=[]},dragStartDellArmada(d){const a=h();this.formDelArmada.id_penumpang.push(a.armada.penumpang[d].id)},allowDropDelArmada(d){d.preventDefault()},dropDelArmada(d,a){d.preventDefault(),this.hitDelArmada(this.formDelArmada,a),this.formDelArmada.id_penumpang=[]},async hitAddArmada(d,a){try{await _.put(`penumpang/armada/${a}`,d).then(o=>{const r=h();r.getData(),r.getDataDetail(a)})}catch{}},async hitDelArmada(d,a){try{await _.put("penumpang/armada/delete",d).then(o=>{const r=h();r.getData(),r.getDataDetail(a)})}catch{}}}}),U=e("h3",null,"Pengelolaan Data Penumpang",-1),$=e("hr",null,null,-1),B={class:"row"},K={class:"col-md-6"},L={class:"row"},R={class:"col-md-2"},j={class:"col-md-8"},E=e("hr",null,null,-1),F={class:"mb-1"},z=e("b",null,"Dropspot : ",-1),H=e("p",{class:"mb-1"},[e("b",null,"Pendamping : "),u("-")],-1),J=e("p",{class:"mb-1"},[e("b",null,"No. HP : "),u("-")],-1),O=e("hr",null,null,-1),Q={class:"mb-1"},W=e("b",null,"Jumlah Penumpang : ",-1),q=e("hr",null,null,-1),G={class:"badge bg-success"},X={class:"table-responsive"},Y=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"No"),e("th",{scope:"col"},"Nama"),e("th",{scope:"col"},"Dropspot")])],-1),Z=["onDragstart","onClick"],aa={class:"col-md-6"},ea={class:"filter-box mb-5 row"},ta={class:"col-md-4"},sa=e("option",{value:"",selected:""},"Semua Area",-1),da=["value"],oa=["disabled"],la=e("option",{value:"",selected:""},"Semua Dropsot",-1),na=["value"],ra={class:"col-md-4"},ia=e("option",{value:"",selected:""},"Semua Jenis Kelamin",-1),ma=e("option",{value:"L",selected:""},"Laki-laki",-1),pa=e("option",{value:"P",selected:""},"Perempuan",-1),ca=[ia,ma,pa],ua=N('<option value="" selected>Limit by Kapasitas</option><option value="60" selected>BUS (60)</option><option value="34" selected>Mini Bus (34)</option><option value="18" selected>ELF (18)</option><option value="13" selected>HIACE (13)</option><option value="7" selected>MPV (8)</option>',6),ha=[ua],ga={class:"serach-box row"},Aa={class:"col-md-8 d-flex align-items-center mb-2"},_a={class:"col-md-4 d-flex align-items-center"},Da=e("hr",null,null,-1),fa={class:"badge bg-success"},va={class:"table-responsive"},ba=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"No"),e("th",{scope:"col"},"Nama"),e("th",{scope:"col"},"Wilayah")])],-1),xa=["onDragstart","onClick"],Ia={__name:"DetailPage",setup(d){const a=h(),o=T(),r=k(),n=D=>o.formAddArmada.id_penumpang.includes(a.items[D].id),I=D=>o.formDelArmada.id_penumpang.includes(a.armada.penumpang[D].id);return P(()=>{a.getData(),a.getDataDetail(r.params.id)}),(D,l)=>{const S=C("font-awesome-icon");return c(),p(g,null,[U,$,e("div",B,[e("div",K,[e("div",L,[e("div",R,[V(S,{icon:"bus",class:"icon",style:{"font-size":"100px"}})]),e("div",j,[e("h3",null,i(t(a).armada.nama),1),E,e("p",F,[z,u(i(t(a).armada.dropspot?t(a).armada.dropspot.nama:"-"),1)]),H,J,O,e("p",Q,[W,u(i(t(a).armada.penumpang?t(a).armada.penumpang.length:0),1)])])]),q,u(" Total "),e("p",G,i(t(o).formDelArmada.id_penumpang.length),1),u(" item dipilih "),e("div",X,[e("table",{class:"table table-sm table-hover mt-3",onDragover:l[0]||(l[0]=(...s)=>t(o).allowDropAddArmada&&t(o).allowDropAddArmada(...s)),onDrop:l[1]||(l[1]=s=>t(o).dropAddArmada(s,t(r).params.id))},[Y,e("tbody",null,[(c(!0),p(g,null,f(t(a).armada.penumpang,(s,m)=>(c(),p("tr",{key:m,draggable:"true",onDragstart:b=>t(o).dragStartDellArmada(m),onClick:b=>t(o).handleRowDelArmada(m),class:x({"table-active":I(m)})},[e("td",null,i(m+1),1),e("td",null,i(s.santri.nama_lengkap),1),e("td",null,i(s.dropspot?s.dropspot.nama:"-"),1)],42,Z))),128))])],32)])]),e("div",aa,[e("div",ea,[e("div",ta,[A(e("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[2]||(l[2]=s=>t(a).params.area=s),onChange:l[3]||(l[3]=(...s)=>t(a).getDropspot&&t(a).getDropspot(...s))},[sa,(c(!0),p(g,null,f(t(a).filter.area,s=>(c(),p("option",{key:s,value:s.id},i(s.nama),9,da))),128))],544),[[v,t(a).params.area]]),A(e("select",{class:"form-select form-select-sm mb-2",disabled:t(a).params.area==="","onUpdate:modelValue":l[4]||(l[4]=s=>t(a).params.dropspot=s),onChange:l[5]||(l[5]=(...s)=>t(a).getData&&t(a).getData(...s))},[la,(c(!0),p(g,null,f(t(a).filter.dropspot,s=>(c(),p("option",{key:s,value:s.id},i(s.nama),9,na))),128))],40,oa),[[v,t(a).params.dropspot]])]),e("div",ra,[A(e("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[6]||(l[6]=s=>t(a).params.jenis_kelamin=s),onChange:l[7]||(l[7]=(...s)=>t(a).getData&&t(a).getData(...s))},ca,544),[[v,t(a).params.jenis_kelamin]]),A(e("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[8]||(l[8]=s=>t(a).params.limit=s),onChange:l[9]||(l[9]=(...s)=>t(a).getData&&t(a).getData(...s))},ha,544),[[v,t(a).params.limit]])])]),e("div",ga,[e("div",Aa,[e("small",null,"Total data "+i(t(a).meta.x_total_data),1)]),e("div",_a,[A(e("input",{type:"text","onUpdate:modelValue":l[10]||(l[10]=s=>t(a).params.cari=s),class:"form-control form-control-sm mb-2",placeholder:"Cari Santri ...",onKeyup:l[11]||(l[11]=(...s)=>t(a).getData&&t(a).getData(...s))},null,544),[[M,t(a).params.cari]])])]),Da,u(" Total "),e("p",fa,i(t(o).formAddArmada.id_penumpang.length),1),u(" item dipilih "),e("div",va,[e("table",{class:"table table-sm table-hover mt-3",onDragover:l[12]||(l[12]=(...s)=>t(o).allowDropDelArmada&&t(o).allowDropDelArmada(...s)),onDrop:l[13]||(l[13]=s=>t(o).dropDelArmada(s,t(r).params.id))},[ba,e("tbody",null,[(c(!0),p(g,null,f(t(a).items,(s,m)=>(c(),p("tr",{key:m,draggable:"true",onDragstart:b=>t(o).dragStartAddArmada(m),onClick:b=>t(o).handleRowClickAddArmada(m),class:x({"table-active":n(m)})},[e("td",null,i(m+1),1),e("td",null,i(s.santri.nama_lengkap),1),e("td",null,i(s.santri.wilayah),1)],42,xa))),128))])],32)])])])],64)}}};export{Ia as default};
