import{x as k,D as V,C as g,i as M,j as N,o as $,a as U,c as p,b as a,k as x,t as i,u as t,m as u,d as h,y as I,F as _,q as f,E as v,v as j,g as c,n as S,G as T}from"./index-b6f2157a.js";import{u as B}from"./index-f4d3e8b4.js";const A=k("table_armada_detail",{state:()=>({user:localStorage.getItem("user")?V():null,armada:{},items:[],filter:{area:[],dropspot:[]},meta:{},params:{cari:"",armada:"n",area:"",dropspot:"",jenis_kelamin:"",limit:""}}),actions:{async getData(){const d={params:this.params};try{await g.get("penumpang",d).then(s=>{(s.data.code=200)&&(this.items=s.data.data,this.filter.area=s.data.filter.area,this.meta=s.headers)})}catch{}},async getDropspot(){this.params.dropspot="",this.getData();const d={params:{area:this.params.area}};try{await g.get("dropspot",d).then(s=>{(s.data.code=200)&&(this.filter.dropspot=s.data.data)})}catch{}},async getDataDetail(d){try{await g.get(`armada/${d}`).then(s=>{(s.data.code=200)&&(this.armada=s.data.data)})}catch{}}}}),K=k("form_armada_detail",{state:()=>({formAddArmada:{id_penumpang:[]},formDelArmada:{id_penumpang:[]},lastSelectedIndexAddArmada:null,lastSelectedIndexDelArmada:null}),actions:{handleRowClickAddArmada(d){const s=d;if(event.shiftKey&&this.lastSelectedIndexAddArmada!==null){const e=Math.min(d,this.lastSelectedIndexAddArmada),n=Math.max(d,this.lastSelectedIndexAddArmada);if(s===n)for(let r=e+1;r<=n;r++)this.addIdPenumpangAddArmada(r);else if(s===e)for(let r=e;r+1<=n;r++)this.addIdPenumpangAddArmada(r);else for(let r=e;r<=n;r++)this.addIdPenumpangAddArmada(r)}else this.addIdPenumpangAddArmada(d);this.lastSelectedIndexAddArmada=d},handleRowDelArmada(d){const s=d;if(event.shiftKey&&this.lastSelectedIndexDelArmada!==null){const e=Math.min(d,this.lastSelectedIndexDelArmada),n=Math.max(d,this.lastSelectedIndexDelArmada);if(s===n)for(let r=e+1;r<=n;r++)this.addIdPenumpangDelArmada(r);else if(s===e)for(let r=e;r+1<=n;r++)this.addIdPenumpangDelArmada(r);else for(let r=e;r<=n;r++)this.addIdPenumpangDelArmada(r)}else this.addIdPenumpangDelArmada(d);this.lastSelectedIndexDelArmada=d},addIdPenumpangAddArmada(d){const s=A(),e=this.formAddArmada.id_penumpang.indexOf(s.items[d].id);e===-1?this.formAddArmada.id_penumpang.push(s.items[d].id):this.formAddArmada.id_penumpang.splice(e,1)},addIdPenumpangDelArmada(d){const s=A(),e=this.formDelArmada.id_penumpang.indexOf(s.armada.penumpang[d].id);e===-1?this.formDelArmada.id_penumpang.push(s.armada.penumpang[d].id):this.formDelArmada.id_penumpang.splice(e,1)},dragStartAddArmada(d){const s=A();this.formAddArmada.id_penumpang.push(s.items[d].id)},allowDropAddArmada(d){d.preventDefault()},dropAddArmada(d,s){d.preventDefault(),this.hitAddArmada(this.formAddArmada,s),this.formAddArmada.id_penumpang=[]},dragStartDellArmada(d){const s=A();this.formDelArmada.id_penumpang.push(s.armada.penumpang[d].id)},allowDropDelArmada(d){d.preventDefault()},dropDelArmada(d,s){d.preventDefault(),this.hitDelArmada(this.formDelArmada,s),this.formDelArmada.id_penumpang=[]},moveArmadaAdd(d,s){const e=Object.values(d);this.formAddArmada.id_penumpang=e,this.hitAddArmada(this.formAddArmada,s),this.formAddArmada.id_penumpang=[]},moveArmadaDell(d,s){const e=Object.values(d);this.formDelArmada.id_penumpang=e,this.hitDelArmada(this.formDelArmada,s),this.formDelArmada.id_penumpang=[]},async hitAddArmada(d,s){try{await g.put(`penumpang/armada/${s}`,d).then(e=>{const n=A();n.getData(),n.getDataDetail(s)})}catch{}},async hitDelArmada(d,s){try{await g.put("penumpang/armada/delete",d).then(e=>{const n=A();n.getData(),n.getDataDetail(s)})}catch{}}}}),L=a("h3",{class:"titlePage"},"Pengelolaan Data Penumpang",-1),R=a("hr",null,null,-1),z={key:0,class:"row"},E={class:"col-md-6"},F={class:"row"},O={class:"col-md-2"},H={class:"col-md-10"},J=a("hr",null,null,-1),q={class:"mb-1"},G=a("b",null,"Dropspot : ",-1),W={class:"mb-1"},Q=a("b",null,"Pendamping : ",-1),X={class:"mb-1"},Y=a("b",null,"No. HP : ",-1),Z=a("hr",null,null,-1),aa={class:"mb-1"},ea=a("b",null,"Jumlah Penumpang : ",-1),ta=a("hr",null,null,-1),sa={class:"row"},da={class:"col"},oa={class:"badge bg-success"},na={class:"col text-center"},la={class:"table-responsive"},ra=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"No"),a("th",{scope:"col"},"Nama"),a("th",{scope:"col"},"Dropspot")])],-1),ia=["onDragstart","onClick"],ma={class:"col-md-6"},pa={class:"filter-box mb-5 row"},ca={class:"col-md-4"},ua=a("option",{value:"",selected:""},"Semua Area",-1),ha=["value"],Aa=["disabled"],_a=a("option",{value:"",selected:""},"Semua Dropsot",-1),ga=["value"],Da={class:"col-md-4"},fa=a("option",{value:"",selected:""},"Semua Jenis Kelamin",-1),va=a("option",{value:"L",selected:""},"Laki-laki",-1),ba=a("option",{value:"P",selected:""},"Perempuan",-1),ya=[fa,va,ba],xa=T('<option value="" selected>Limit by Kapasitas</option><option value="60" selected>BUS (60)</option><option value="34" selected>Mini Bus (34)</option><option value="18" selected>ELF (18)</option><option value="13" selected>HIACE (13)</option><option value="7" selected>MPV (8)</option>',6),wa=[xa],Ia={class:"serach-box row"},Sa={class:"col-md-8 d-flex align-items-center mb-2"},ka={class:"col-md-4 d-flex align-items-center"},Pa=a("hr",null,null,-1),Ca={class:"row"},Va={class:"col"},Ma={class:"badge bg-success"},Na={class:"col text-center"},$a={class:"table-responsive"},Ua=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"No"),a("th",{scope:"col"},"Nama"),a("th",{scope:"col"},"Wilayah")])],-1),ja=["onDragstart","onClick"],Ta={key:1},La={__name:"DetailPage",setup(d){const s=B(),e=A(),n=K(),r=M(),w=N(()=>s.user?s.user.role:"wilayah"),P=D=>n.formAddArmada.id_penumpang.includes(e.items[D].id),C=D=>n.formDelArmada.id_penumpang.includes(e.armada.penumpang[D].id);return $(()=>{e.getData(),e.getDataDetail(r.params.id)}),(D,l)=>{const b=U("font-awesome-icon");return c(),p(_,null,[L,R,w.value==="sysadmin"||w.value==="admin"?(c(),p("div",z,[a("div",E,[a("div",F,[a("div",O,[x(b,{icon:"bus",class:"icon",style:{"font-size":"100px"}})]),a("div",H,[a("h3",null,i(t(e).armada.nama),1),J,a("p",q,[G,u(i(t(e).armada.dropspot?t(e).armada.dropspot.nama:"-"),1)]),a("p",W,[Q,u(i(t(e).armada.user?t(e).armada.user.nama_lengkap:"-"),1)]),a("p",X,[Y,u(i(t(e).armada.user?t(e).armada.user.no_hp:"-"),1)]),Z,a("p",aa,[ea,u(i(t(e).armada.penumpang?t(e).armada.penumpang.length:0),1)])])]),ta,a("div",sa,[a("div",da,[u(" Total "),a("p",oa,i(t(n).formDelArmada.id_penumpang.length),1),u(" item dipilih ")]),h(a("div",na,[x(b,{icon:"arrow-right",class:"icon badge bg-primary p-2",style:{cursor:"pointer","font-size":"medium"},onClick:l[0]||(l[0]=o=>t(n).moveArmadaDell(t(n).formDelArmada.id_penumpang,t(r).params.id))})],512),[[I,t(n).formDelArmada.id_penumpang?t(n).formDelArmada.id_penumpang.length>0:""]])]),a("div",la,[a("table",{class:"table table-sm table-hover mt-3",onDragover:l[1]||(l[1]=(...o)=>t(n).allowDropAddArmada&&t(n).allowDropAddArmada(...o)),onDrop:l[2]||(l[2]=o=>t(n).dropAddArmada(o,t(r).params.id))},[ra,a("tbody",null,[(c(!0),p(_,null,f(t(e).armada.penumpang,(o,m)=>(c(),p("tr",{key:m,draggable:"true",onDragstart:y=>t(n).dragStartDellArmada(m),onClick:y=>t(n).handleRowDelArmada(m),class:S({"table-active":C(m)})},[a("td",null,i(m+1),1),a("td",null,i(o.santri.nama_lengkap),1),a("td",null,i(o.dropspot?o.dropspot.nama:"-"),1)],42,ia))),128))])],32)])]),a("div",ma,[a("div",pa,[a("div",ca,[h(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[3]||(l[3]=o=>t(e).params.area=o),onChange:l[4]||(l[4]=(...o)=>t(e).getDropspot&&t(e).getDropspot(...o))},[ua,(c(!0),p(_,null,f(t(e).filter.area,o=>(c(),p("option",{key:o,value:o.id},i(o.nama),9,ha))),128))],544),[[v,t(e).params.area]]),h(a("select",{class:"form-select form-select-sm mb-2",disabled:t(e).params.area==="","onUpdate:modelValue":l[5]||(l[5]=o=>t(e).params.dropspot=o),onChange:l[6]||(l[6]=(...o)=>t(e).getData&&t(e).getData(...o))},[_a,(c(!0),p(_,null,f(t(e).filter.dropspot,o=>(c(),p("option",{key:o,value:o.id},i(o.nama),9,ga))),128))],40,Aa),[[v,t(e).params.dropspot]])]),a("div",Da,[h(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[7]||(l[7]=o=>t(e).params.jenis_kelamin=o),onChange:l[8]||(l[8]=(...o)=>t(e).getData&&t(e).getData(...o))},ya,544),[[v,t(e).params.jenis_kelamin]]),h(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[9]||(l[9]=o=>t(e).params.limit=o),onChange:l[10]||(l[10]=(...o)=>t(e).getData&&t(e).getData(...o))},wa,544),[[v,t(e).params.limit]])])]),a("div",Ia,[a("div",Sa,[a("small",null,"Total data "+i(t(e).meta.x_total_data),1)]),a("div",ka,[h(a("input",{type:"text","onUpdate:modelValue":l[11]||(l[11]=o=>t(e).params.cari=o),class:"form-control form-control-sm mb-2",placeholder:"Cari Santri ...",onKeyup:l[12]||(l[12]=(...o)=>t(e).getData&&t(e).getData(...o))},null,544),[[j,t(e).params.cari]])])]),Pa,a("div",Ca,[a("div",Va,[u(" Total "),a("p",Ma,i(t(n).formAddArmada.id_penumpang.length),1),u(" item dipilih ")]),h(a("div",Na,[x(b,{icon:"arrow-left",class:"icon badge bg-primary p-2",style:{cursor:"pointer","font-size":"medium"},onClick:l[13]||(l[13]=o=>t(n).moveArmadaAdd(t(n).formAddArmada.id_penumpang,t(r).params.id))})],512),[[I,t(n).formAddArmada.id_penumpang?t(n).formAddArmada.id_penumpang.length>0:""]])]),a("div",$a,[a("table",{class:"table table-sm table-hover mt-3",onDragover:l[14]||(l[14]=(...o)=>t(n).allowDropDelArmada&&t(n).allowDropDelArmada(...o)),onDrop:l[15]||(l[15]=o=>t(n).dropDelArmada(o,t(r).params.id))},[Ua,a("tbody",null,[(c(!0),p(_,null,f(t(e).items,(o,m)=>(c(),p("tr",{key:m,draggable:"true",onDragstart:y=>t(n).dragStartAddArmada(m),onClick:y=>t(n).handleRowClickAddArmada(m),class:S({"table-active":P(m)})},[a("td",null,i(m+1),1),a("td",null,i(o.santri.nama_lengkap),1),a("td",null,i(o.santri.wilayah),1)],42,ja))),128))])],32)])])])):(c(),p("div",Ta,"wilayah"))],64)}}};export{La as default};
