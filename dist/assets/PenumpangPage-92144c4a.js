import{x as E,C as c,s as x,S as O,a as C,g as l,c as r,b as a,d as p,E as u,u as e,F as h,q as b,t as d,v as D,w as _,z as m,e as w,f as S,n as v,G as k}from"./index-c6286ee1.js";const y=E("table_penumpang",{state:()=>({items:[],meta:{},myPage:"",filter:{area:[],dropspot:[],wilayah:[],blok:[]},params:{cari:"",dropspot:"",area:"",wilayah:"",blok:"",pembayaran:"",jenis_kelamin:"",page:1,limit:25}}),actions:{nexPage(n){this.params.page=parseInt(n)+1,this.getData()},prevPage(n){this.params.page=parseInt(n)-1,this.getData()},setPage(n){this.params.page=parseInt(n),this.getData()},searchPage(){this.params.page=1,this.getData()},async getData(){const n={params:this.params};try{await c.get("penumpang",n).then(s=>{(s.data.code=200)&&(this.totalData=s.headers.x_total_data,this.items=s.data.data,this.meta=s.headers,this.filter.area=s.data.filter.area)})}catch{}},async getDropspot(){this.params.dropspot="",this.getData();const n={params:{area:this.params.area}};try{await c.get("dropspot",n).then(s=>{(s.data.code=200)&&(this.filter.dropspot=s.data.data)})}catch{}},async getWilayah(){try{await c.get("santri/filter/wilayah").then(n=>{(n.data.code=200)&&(this.filter.wilayah=n.data)})}catch{}},async getBlok(){this.params.blok="",this.getData();try{await c.get(`santri/filter/blok?alias_wilayah=${this.params.wilayah}`).then(n=>{(n.data.code=200)&&(this.filter.blok=n.data)})}catch{}}}}),L=E("form_penumpang",{state:()=>({contextMenuVisible:!1,contextMenuPosition:{x:0,y:0},isOpenEditDropspot:!1,isOpenEditPembayaran:!1,isArea:[],isDropspot:[],idEdit:"",idDelete:"",idArea:"",dataEdit:{},formEditDropspot:{dropspot_id:""},formEditPembayaran:{jumlah_bayar:"",status_bayar:""}}),actions:{showContextMenu(n,s){n.preventDefault(),this.dataEdit=s,this.idEdit=s.id,this.contextMenuPosition={x:n.clientX,y:n.clientY},this.contextMenuVisible=!0,document.addEventListener("click",this.handleOutsideClick)},handleOutsideClick(n){this.contextMenuVisible=!1,document.removeEventListener("click",this.handleOutsideClick)},resetFormEditDropspot(){this.formEditDropspot.dropspot_id=""},resetFormEditPembayaran(){this.formEditPembayaran.jumlah_bayar="",this.formEditPembayaran.status_bayar=""},setOpenEditDropspot(){this.isOpenEditDropspot=!this.isOpenEditDropspot,this.resetFormEditDropspot()},setOpenEditPembayaran(){this.isOpenEditPembayaran=!this.isOpenEditPembayaran,this.resetFormEditPembayaran()},handleOpenEditDropspot(){this.idArea=this.dataEdit.dropspot.area_id,this.getArea(),this.getDropspot(),this.formEditDropspot.dropspot_id=this.dataEdit.dropspot_id,this.isOpenEditDropspot=!0},handleOpenEditPembayaran(){this.formEditPembayaran.status_bayar=this.dataEdit.status_bayar,this.formEditPembayaran.jumlah_bayar=this.dataEdit.jumlah_bayar,this.isOpenEditPembayaran=!0},goToDetail(){x.push(`penumpang/${this.dataEdit.santri_uuid}/detail`)},getArea(){try{c.get("area").then(n=>{this.isArea=n.data.data})}catch{}},async getDropspot(){this.formEditDropspot.dropspot_id="";const n={params:{area:this.idArea}};try{await c.get("dropspot",n).then(s=>{this.isDropspot=s.data.data})}catch{}},async editDropspot(){try{await c.put(`penumpang/dropspot/${this.idEdit}`,this.formEditDropspot).then(n=>{this.isOpenEditDropspot=!1,this.resetFormEditDropspot(),y().getData()})}catch{}},async editPembayaran(){try{await c.put(`penumpang/pembayaran/${this.idEdit}`,this.formEditPembayaran).then(n=>{this.isOpenEditPembayaran=!1,this.resetFormEditPembayaran(),y().getData()})}catch{}},async deleteRombongan(){O.fire({title:"Konfirmasi",text:"Apakah anda yakin ingin mengeluarkan dari rombongan ?",icon:"info",showCancelButton:!0,confirmButtonText:"keluarkan",confirmButtonColor:"#DC3545"}).then(n=>{n.isConfirmed&&c.delete(`penumpang/${this.dataEdit.santri_uuid}`).then(s=>{this.isOpenEdit=!1,y().getData()})})}}});const V=a("h3",{class:"titlePage"},"Data Penumpang",-1),A=a("hr",null,null,-1),M={class:"filter-box mb-5 row"},U={class:"col-md-2"},B=a("option",{value:"",selected:""},"Semua Wilayah",-1),F=["value"],j=["disabled"],T=a("option",{value:"",selected:""},"Semua Daerah",-1),N=["value"],z={class:"col-md-2"},K=a("option",{value:"",selected:""},"Semua Area",-1),R=["value"],$=["disabled"],I=a("option",{value:"",selected:""},"Semua Dropsot",-1),W=["value"],J={class:"col-md-2"},q=k('<option value="" selected>Semua Status Pembayaran</option><option value="belum-lunas">Belum Lunas</option><option value="lunas">Lunas</option><option value="kurang">Kurang</option><option value="lebih">Lebih</option>',5),G=[q],H=a("option",{value:"",selected:""},"Semua Jenis Kelamin",-1),X=a("option",{value:"L"},"Laki-Laki",-1),Y=a("option",{value:"P"},"Perempuan",-1),Q=[H,X,Y],Z={class:"serach-box row"},tt={class:"col-md-10 d-flex align-items-center mb-2"},at={class:"col-md-2 d-flex align-items-center"},et=a("hr",null,null,-1),st={class:"table-responsive"},ot={class:"table table-sm table-hover mt-3"},it=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"No"),a("th",{scope:"col"},"NIUP"),a("th",{scope:"col"},"Nama Santri"),a("th",{scope:"col"},"Dropsot"),a("th",{scope:"col"},"Area"),a("th",{scope:"col"},"Tarif"),a("th",{scope:"col"},"Jumlah Bayar"),a("th",{scope:"col"},"Status Pembayaran"),a("th",{scope:"col"},"Wilayah"),a("th",{scope:"col"},"Daerah"),a("th",{scope:"col"},"Kecamatan"),a("th",{scope:"col"},"Kabupaten"),a("th",{scope:"col"},"Provinsi")])],-1),nt=["onDblclick","onContextmenu"],lt={key:0},rt={key:1,class:"text-danger"},dt=a("i",null,"belum-ditentukan",-1),pt=[dt],mt={key:2},ut={key:3,class:"text-danger"},ct=a("i",null,"belum-ditentukan",-1),ht=[ct],bt={key:4},_t={key:5,class:"text-danger"},yt={key:0,class:"badge bg-danger text-capitalize"},gt={key:1,class:"badge bg-success text-capitalize"},ft={key:2,class:"badge bg-warning text-capitalize"},Dt={key:3,class:"badge bg-info text-capitalize"},vt={key:0},Et={class:"list-group list-group-flush"},kt={class:"modal-dialog"},Pt={class:"modal-content"},xt={class:"modal-header"},Ot=a("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit Dropsot",-1),Ct={class:"modal-body"},wt={class:"form-group mb-3"},St=a("small",null,"Area",-1),Lt=a("option",{value:"",selected:""},"Pilih Area",-1),Vt=["value"],At={class:"form-group mb-3"},Mt=a("small",null,"Dropspot",-1),Ut=["disabled"],Bt={key:0,value:"",selected:""},Ft=["value"],jt={class:"modal-footer"},Tt=a("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),Nt={class:"modal-dialog"},zt={class:"modal-content"},Kt={class:"modal-header"},Rt=a("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit Pembayaran",-1),$t={class:"modal-body"},It={class:"form-group mb-3"},Wt=a("small",null,"Jumlah Pembayaran",-1),Jt={class:"form-group mb-3"},qt=a("small",null,"Status Pembayaran",-1),Gt=k('<option value="" selected>Pilih Status</option><option value="lunas" selected>Lunas</option><option value="belum-lunas" selected>Belum Lunas</option><option value="lebih" selected>Lebih</option><option value="kurang" selected>Kurang</option>',5),Ht=[Gt],Xt={class:"modal-footer"},Yt=a("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),ta={__name:"PenumpangPage",setup(n){const s=y(),i=L();return s.getData(),s.getWilayah(),(Qt,o)=>{const P=C("app-paginate");return l(),r(h,null,[V,A,a("div",M,[a("div",U,[p(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[0]||(o[0]=t=>e(s).params.wilayah=t),onChange:o[1]||(o[1]=(...t)=>e(s).getBlok&&e(s).getBlok(...t))},[B,(l(!0),r(h,null,b(e(s).filter.wilayah,t=>(l(),r("option",{key:t,value:t.alias_wilayah},d(t.wilayah),9,F))),128))],544),[[u,e(s).params.wilayah]]),p(a("select",{class:"form-select form-select-sm mb-2",disabled:e(s).params.wilayah==="","onUpdate:modelValue":o[2]||(o[2]=t=>e(s).params.blok=t),onChange:o[3]||(o[3]=(...t)=>e(s).getData&&e(s).getData(...t))},[T,(l(!0),r(h,null,b(e(s).filter.blok,t=>(l(),r("option",{key:t,value:t.id_blok},d(t.blok),9,N))),128))],40,j),[[u,e(s).params.blok]])]),a("div",z,[p(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[4]||(o[4]=t=>e(s).params.area=t),onChange:o[5]||(o[5]=(...t)=>e(s).getDropspot&&e(s).getDropspot(...t))},[K,(l(!0),r(h,null,b(e(s).filter.area,t=>(l(),r("option",{key:t,value:t.id},d(t.nama),9,R))),128))],544),[[u,e(s).params.area]]),p(a("select",{class:"form-select form-select-sm mb-2",disabled:e(s).params.area==="","onUpdate:modelValue":o[6]||(o[6]=t=>e(s).params.dropspot=t),onChange:o[7]||(o[7]=(...t)=>e(s).getData&&e(s).getData(...t))},[I,(l(!0),r(h,null,b(e(s).filter.dropspot,t=>(l(),r("option",{key:t,value:t.id},d(t.nama),9,W))),128))],40,$),[[u,e(s).params.dropspot]])]),a("div",J,[p(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[8]||(o[8]=t=>e(s).params.pembayaran=t),onChange:o[9]||(o[9]=(...t)=>e(s).getData&&e(s).getData(...t))},G,544),[[u,e(s).params.pembayaran]]),p(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[10]||(o[10]=t=>e(s).params.jenis_kelamin=t),onChange:o[11]||(o[11]=(...t)=>e(s).getData&&e(s).getData(...t))},Q,544),[[u,e(s).params.jenis_kelamin]])])]),a("div",Z,[a("div",tt,[a("small",null,"Total data "+d(e(s).totalData),1)]),a("div",at,[p(a("input",{type:"text","onUpdate:modelValue":o[12]||(o[12]=t=>e(s).params.cari=t),class:"form-control form-control-sm mb-2",placeholder:"Cari Penumpang ...",onKeyup:o[13]||(o[13]=(...t)=>e(s).getData&&e(s).getData(...t))},null,544),[[D,e(s).params.cari]])])]),et,a("div",st,[a("table",ot,[it,a("tbody",null,[(l(!0),r(h,null,b(e(s).items,(t,f)=>(l(),r("tr",{style:{cursor:"pointer"},key:f,onDblclick:_(g=>e(i).showContextMenu(g,t),["prevent"]),onContextmenu:_(g=>e(i).showContextMenu(g,t),["prevent"])},[a("td",null,d(f+1+(e(s).params.page-1)*e(s).params.limit),1),a("td",null,d(t.santri.niup),1),a("td",null,d(t.santri.nama_lengkap),1),t.dropspot?(l(),r("td",lt,d(t.dropspot.nama),1)):(l(),r("td",rt,pt)),t.dropspot?(l(),r("td",mt,d(t.dropspot.area.nama),1)):(l(),r("td",ut,ht)),t.dropspot?(l(),r("td",bt,d("Rp. "+t.dropspot.harga),1)):(l(),r("td",_t,"Rp. 0")),a("td",null,d("Rp. "+t.jumlah_bayar),1),a("td",null,[t.status_bayar==="belum-lunas"?(l(),r("i",yt,d(t.status_bayar==="belum-lunas"?"belum lunas":""),1)):m("",!0),t.status_bayar==="lunas"?(l(),r("i",gt,d(t.status_bayar),1)):m("",!0),t.status_bayar==="kurang"?(l(),r("i",ft,d(t.status_bayar),1)):m("",!0),t.status_bayar==="lebih"?(l(),r("i",Dt,d(t.status_bayar),1)):m("",!0)]),a("td",null,d(t.santri.wilayah),1),a("td",null,d(t.santri.blok),1),a("td",null,d(t.santri.kecamatan),1),a("td",null,d(t.santri.kabupaten),1),a("td",null,d(t.santri.provinsi),1)],40,nt))),128))])])]),e(s).items.length>0?(l(),r("div",vt,[e(s).meta.x_total_data?(l(),w(P,{key:0,meta:e(s).meta,per_page:e(s).params.limit,onSetPage:o[14]||(o[14]=t=>e(s).setPage(t)),onNext:e(s).nexPage,onPrev:e(s).prevPage,onLast:e(s).setPage,onFirst:e(s).setPage},null,8,["meta","per_page","onNext","onPrev","onLast","onFirst"])):m("",!0)])):m("",!0),e(i).contextMenuVisible?(l(),r("div",{key:1,class:"context-menu",style:S({top:`${e(i).contextMenuPosition.y}px`,left:`${e(i).contextMenuPosition.x}px`})},[a("ul",Et,[a("li",{class:"list-group-item px-5",onClick:o[15]||(o[15]=(...t)=>e(i).handleOpenEditDropspot&&e(i).handleOpenEditDropspot(...t))}," Ubah Dropsot "),a("li",{class:"list-group-item px-5",onClick:o[16]||(o[16]=(...t)=>e(i).handleOpenEditPembayaran&&e(i).handleOpenEditPembayaran(...t))}," Ubah Status Pembayaran "),a("li",{class:"list-group-item px-5",onClick:o[17]||(o[17]=(...t)=>e(i).goToDetail&&e(i).goToDetail(...t))}," Lihat Detail Rombongan "),a("li",{class:"list-group-item px-5",onClick:o[18]||(o[18]=(...t)=>e(i).deleteRombongan&&e(i).deleteRombongan(...t))}," Hapus Penumpang ")])],4)):m("",!0),e(i).isOpenEditDropspot===!0?(l(),r("div",{key:2,class:v(["modal fade",{show:e(i).isOpenEditDropspot}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[a("div",kt,[a("div",Pt,[a("div",xt,[Ot,a("button",{class:"btn-close",type:"button",onClick:o[19]||(o[19]=(...t)=>e(i).setOpenEditDropspot&&e(i).setOpenEditDropspot(...t))})]),a("form",{onSubmit:o[24]||(o[24]=_((...t)=>e(i).editDropspot&&e(i).editDropspot(...t),["prevent"]))},[a("div",Ct,[a("div",wt,[St,p(a("select",{class:"form-select","onUpdate:modelValue":o[20]||(o[20]=t=>e(i).idArea=t),onChange:o[21]||(o[21]=(...t)=>e(i).getDropspot&&e(i).getDropspot(...t))},[Lt,(l(!0),r(h,null,b(e(i).isArea,t=>(l(),r("option",{key:t,value:t.id},d(t.nama),9,Vt))),128))],544),[[u,e(i).idArea]])]),a("div",At,[Mt,p(a("select",{class:"form-select","onUpdate:modelValue":o[22]||(o[22]=t=>e(i).formEditDropspot.dropspot_id=t),disabled:e(i).idArea===""},[e(i).formEditDropspot.dropspot_id===""?(l(),r("option",Bt," Pilih Dropspot ")):m("",!0),(l(!0),r(h,null,b(e(i).isDropspot,t=>(l(),r("option",{key:t,value:t.id},d(t.nama),9,Ft))),128))],8,Ut),[[u,e(i).formEditDropspot.dropspot_id]])])]),a("div",jt,[a("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:o[23]||(o[23]=(...t)=>e(i).setOpenEditDropspot&&e(i).setOpenEditDropspot(...t))}," Tutup "),Tt])],32)])])],2)):m("",!0),e(i).isOpenEditPembayaran===!0?(l(),r("div",{key:3,class:v(["modal fade",{show:e(i).isOpenEditPembayaran}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[a("div",Nt,[a("div",zt,[a("div",Kt,[Rt,a("button",{class:"btn-close",type:"button",onClick:o[25]||(o[25]=(...t)=>e(i).setOpenEditPembayaran&&e(i).setOpenEditPembayaran(...t))})]),a("form",{onSubmit:o[29]||(o[29]=_((...t)=>e(i).editPembayaran&&e(i).editPembayaran(...t),["prevent"]))},[a("div",$t,[a("div",It,[Wt,p(a("input",{type:"number",class:"form-control mt-2","onUpdate:modelValue":o[26]||(o[26]=t=>e(i).formEditPembayaran.jumlah_bayar=t)},null,512),[[D,e(i).formEditPembayaran.jumlah_bayar]])]),a("div",Jt,[qt,p(a("select",{class:"form-select","onUpdate:modelValue":o[27]||(o[27]=t=>e(i).formEditPembayaran.status_bayar=t)},Ht,512),[[u,e(i).formEditPembayaran.status_bayar]])])]),a("div",Xt,[a("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:o[28]||(o[28]=(...t)=>e(i).setOpenEditPembayaran&&e(i).setOpenEditPembayaran(...t))}," Tutup "),Yt])],32)])])],2)):m("",!0)],64)}}};export{ta as default};
