import{x as D,C as h,s as x,a as O,g as l,c as r,b as a,d as p,E as u,u as e,F as c,q as b,t as d,v as f,w as _,z as m,e as w,f as C,n as v,G as E}from"./index-ed1e1048.js";const y=D("table_penumpang",{state:()=>({items:[],meta:{},myPage:"",filter:{area:[],dropspot:[],wilayah:[],blok:[]},params:{cari:"",dropspot:"",area:"",wilayah:"",blok:"",pembayaran:"",jenis_kelamin:"",page:1,limit:25}}),actions:{nexPage(n){this.params.page=parseInt(n)+1,this.getData()},prevPage(n){this.params.page=parseInt(n)-1,this.getData()},setPage(n){this.params.page=parseInt(n),this.getData()},searchPage(){this.params.page=1,this.getData()},async getData(){const n={params:this.params};try{await h.get("penumpang",n).then(s=>{(s.data.code=200)&&(this.totalData=s.headers.x_total_data,this.items=s.data.data,this.meta=s.headers,this.filter.area=s.data.filter.area)})}catch{}},async getDropspot(){this.params.dropspot="",this.getData();const n={params:{area:this.params.area}};try{await h.get("dropspot",n).then(s=>{(s.data.code=200)&&(this.filter.dropspot=s.data.data)})}catch{}},async getWilayah(){try{await h.get("santri/filter/wilayah").then(n=>{(n.data.code=200)&&(this.filter.wilayah=n.data)})}catch{}},async getBlok(){this.params.blok="",this.getData();try{await h.get(`santri/filter/blok?alias_wilayah=${this.params.wilayah}`).then(n=>{(n.data.code=200)&&(this.filter.blok=n.data)})}catch{}}}}),S=D("form_penumpang",{state:()=>({contextMenuVisible:!1,contextMenuPosition:{x:0,y:0},isOpenEditDropspot:!1,isOpenEditPembayaran:!1,isArea:[],isDropspot:[],idEdit:"",idArea:"",dataEdit:{},formEditDropspot:{dropspot_id:""},formEditPembayaran:{jumlah_bayar:"",status_bayar:""}}),actions:{showContextMenu(n,s){n.preventDefault(),this.dataEdit=s,this.idEdit=s.id,this.contextMenuPosition={x:n.clientX,y:n.clientY},this.contextMenuVisible=!0,document.addEventListener("click",this.handleOutsideClick)},handleOutsideClick(n){this.contextMenuVisible=!1,document.removeEventListener("click",this.handleOutsideClick)},resetFormEditDropspot(){this.formEditDropspot.dropspot_id=""},resetFormEditPembayaran(){this.formEditPembayaran.jumlah_bayar="",this.formEditPembayaran.status_bayar=""},setOpenEditDropspot(){this.isOpenEditDropspot=!this.isOpenEditDropspot,this.resetFormEditDropspot()},setOpenEditPembayaran(){this.isOpenEditPembayaran=!this.isOpenEditPembayaran,this.resetFormEditPembayaran()},handleOpenEditDropspot(){this.idArea=this.dataEdit.dropspot.area_id,this.getArea(),this.getDropspot(),this.formEditDropspot.dropspot_id=this.dataEdit.dropspot_id,this.isOpenEditDropspot=!0},handleOpenEditPembayaran(){this.formEditPembayaran.status_bayar=this.dataEdit.status_bayar,this.formEditPembayaran.jumlah_bayar=this.dataEdit.jumlah_bayar,this.isOpenEditPembayaran=!0},goToDetail(){x.push(`penumpang/${this.dataEdit.santri_uuid}/detail`)},getArea(){try{h.get("area").then(n=>{this.isArea=n.data.data})}catch{}},async getDropspot(){this.formEditDropspot.dropspot_id="";const n={params:{area:this.idArea}};try{await h.get("dropspot",n).then(s=>{this.isDropspot=s.data.data})}catch{}},async editDropspot(){try{await h.put(`penumpang/dropspot/${this.idEdit}`,this.formEditDropspot).then(n=>{this.isOpenEditDropspot=!1,this.resetFormEditDropspot(),y().getData()})}catch{}},async editPembayaran(){try{await h.put(`penumpang/pembayaran/${this.idEdit}`,this.formEditPembayaran).then(n=>{this.isOpenEditPembayaran=!1,this.resetFormEditPembayaran(),y().getData()})}catch{}}}});const L=a("h3",{class:"titlePage"},"Data Penumpang",-1),V=a("hr",null,null,-1),A={class:"filter-box mb-5 row"},U={class:"col-md-2"},M=a("option",{value:"",selected:""},"Semua Wilayah",-1),F=["value"],j=["disabled"],B=a("option",{value:"",selected:""},"Semua Daerah",-1),T=["value"],N={class:"col-md-2"},z=a("option",{value:"",selected:""},"Semua Area",-1),K=["value"],$=["disabled"],I=a("option",{value:"",selected:""},"Semua Dropsot",-1),R=["value"],W={class:"col-md-2"},J=E('<option value="" selected>Semua Status Pembayaran</option><option value="belum-lunas">Belum Lunas</option><option value="lunas">Lunas</option><option value="kurang">Kurang</option><option value="lebih">Lebih</option>',5),q=[J],G=a("option",{value:"",selected:""},"Semua Jenis Kelamin",-1),X=a("option",{value:"L"},"Laki-Laki",-1),Y=a("option",{value:"P"},"Perempuan",-1),H=[G,X,Y],Q={class:"serach-box row"},Z={class:"col-md-10 d-flex align-items-center mb-2"},tt={class:"col-md-2 d-flex align-items-center"},at=a("hr",null,null,-1),et={class:"table-responsive"},st={class:"table table-sm table-hover mt-3"},ot=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"No"),a("th",{scope:"col"},"NIUP"),a("th",{scope:"col"},"Nama Santri"),a("th",{scope:"col"},"Dropsot"),a("th",{scope:"col"},"Area"),a("th",{scope:"col"},"Tarif"),a("th",{scope:"col"},"Jumlah Bayar"),a("th",{scope:"col"},"Status Pembayaran"),a("th",{scope:"col"},"Wilayah"),a("th",{scope:"col"},"Daerah"),a("th",{scope:"col"},"Kecamatan"),a("th",{scope:"col"},"Kabupaten"),a("th",{scope:"col"},"Provinsi")])],-1),it=["onContextmenu"],nt={key:0},lt={key:1,class:"text-danger"},rt=a("i",null,"belum-ditentukan",-1),dt=[rt],pt={key:2},mt={key:3,class:"text-danger"},ut=a("i",null,"belum-ditentukan",-1),ct=[ut],ht={key:4},bt={key:5,class:"text-danger"},_t={key:0,class:"badge bg-danger text-capitalize"},yt={key:1,class:"badge bg-success text-capitalize"},gt={key:2,class:"badge bg-warning text-capitalize"},ft={key:3,class:"badge bg-info text-capitalize"},vt={key:0},Dt={class:"list-group list-group-flush"},Et={class:"modal-dialog"},Pt={class:"modal-content"},kt={class:"modal-header"},xt=a("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit Dropsot",-1),Ot={class:"modal-body"},wt={class:"form-group mb-3"},Ct=a("small",null,"Area",-1),St=a("option",{value:"",selected:""},"Pilih Area",-1),Lt=["value"],Vt={class:"form-group mb-3"},At=a("small",null,"Dropspot",-1),Ut=["disabled"],Mt={key:0,value:"",selected:""},Ft=["value"],jt={class:"modal-footer"},Bt=a("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),Tt={class:"modal-dialog"},Nt={class:"modal-content"},zt={class:"modal-header"},Kt=a("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit Pembayaran",-1),$t={class:"modal-body"},It={class:"form-group mb-3"},Rt=a("small",null,"Jumlah Pembayaran",-1),Wt={class:"form-group mb-3"},Jt=a("small",null,"Status Pembayaran",-1),qt=E('<option value="" selected>Pilih Status</option><option value="lunas" selected>Lunas</option><option value="belum-lunas" selected>Belum Lunas</option><option value="lebih" selected>Lebih</option><option value="kurang" selected>Kurang</option>',5),Gt=[qt],Xt={class:"modal-footer"},Yt=a("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),Zt={__name:"PenumpangPage",setup(n){const s=y(),i=S();return s.getData(),s.getWilayah(),(Ht,o)=>{const P=O("app-paginate");return l(),r(c,null,[L,V,a("div",A,[a("div",U,[p(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[0]||(o[0]=t=>e(s).params.wilayah=t),onChange:o[1]||(o[1]=(...t)=>e(s).getBlok&&e(s).getBlok(...t))},[M,(l(!0),r(c,null,b(e(s).filter.wilayah,t=>(l(),r("option",{key:t,value:t.alias_wilayah},d(t.wilayah),9,F))),128))],544),[[u,e(s).params.wilayah]]),p(a("select",{class:"form-select form-select-sm mb-2",disabled:e(s).params.wilayah==="","onUpdate:modelValue":o[2]||(o[2]=t=>e(s).params.blok=t),onChange:o[3]||(o[3]=(...t)=>e(s).getData&&e(s).getData(...t))},[B,(l(!0),r(c,null,b(e(s).filter.blok,t=>(l(),r("option",{key:t,value:t.id_blok},d(t.blok),9,T))),128))],40,j),[[u,e(s).params.blok]])]),a("div",N,[p(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[4]||(o[4]=t=>e(s).params.area=t),onChange:o[5]||(o[5]=(...t)=>e(s).getDropspot&&e(s).getDropspot(...t))},[z,(l(!0),r(c,null,b(e(s).filter.area,t=>(l(),r("option",{key:t,value:t.id},d(t.nama),9,K))),128))],544),[[u,e(s).params.area]]),p(a("select",{class:"form-select form-select-sm mb-2",disabled:e(s).params.area==="","onUpdate:modelValue":o[6]||(o[6]=t=>e(s).params.dropspot=t),onChange:o[7]||(o[7]=(...t)=>e(s).getData&&e(s).getData(...t))},[I,(l(!0),r(c,null,b(e(s).filter.dropspot,t=>(l(),r("option",{key:t,value:t.id},d(t.nama),9,R))),128))],40,$),[[u,e(s).params.dropspot]])]),a("div",W,[p(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[8]||(o[8]=t=>e(s).params.pembayaran=t),onChange:o[9]||(o[9]=(...t)=>e(s).getData&&e(s).getData(...t))},q,544),[[u,e(s).params.pembayaran]]),p(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[10]||(o[10]=t=>e(s).params.jenis_kelamin=t),onChange:o[11]||(o[11]=(...t)=>e(s).getData&&e(s).getData(...t))},H,544),[[u,e(s).params.jenis_kelamin]])])]),a("div",Q,[a("div",Z,[a("small",null,"Total data "+d(e(s).totalData),1)]),a("div",tt,[p(a("input",{type:"text","onUpdate:modelValue":o[12]||(o[12]=t=>e(s).params.cari=t),class:"form-control form-control-sm mb-2",placeholder:"Cari Penumpang ...",onKeyup:o[13]||(o[13]=(...t)=>e(s).getData&&e(s).getData(...t))},null,544),[[f,e(s).params.cari]])])]),at,a("div",et,[a("table",st,[ot,a("tbody",null,[(l(!0),r(c,null,b(e(s).items,(t,g)=>(l(),r("tr",{key:g,onContextmenu:_(k=>e(i).showContextMenu(k,t),["prevent"])},[a("td",null,d(g+1+(e(s).params.page-1)*e(s).params.limit),1),a("td",null,d(t.santri.niup),1),a("td",null,d(t.santri.nama_lengkap),1),t.dropspot?(l(),r("td",nt,d(t.dropspot.nama),1)):(l(),r("td",lt,dt)),t.dropspot?(l(),r("td",pt,d(t.dropspot.area.nama),1)):(l(),r("td",mt,ct)),t.dropspot?(l(),r("td",ht,d("Rp. "+t.dropspot.harga),1)):(l(),r("td",bt,"Rp. 0")),a("td",null,d("Rp. "+t.jumlah_bayar),1),a("td",null,[t.status_bayar==="belum-lunas"?(l(),r("i",_t,d(t.status_bayar==="belum-lunas"?"belum lunas":""),1)):m("",!0),t.status_bayar==="lunas"?(l(),r("i",yt,d(t.status_bayar),1)):m("",!0),t.status_bayar==="kurang"?(l(),r("i",gt,d(t.status_bayar),1)):m("",!0),t.status_bayar==="lebih"?(l(),r("i",ft,d(t.status_bayar),1)):m("",!0)]),a("td",null,d(t.santri.wilayah),1),a("td",null,d(t.santri.blok),1),a("td",null,d(t.santri.kecamatan),1),a("td",null,d(t.santri.kabupaten),1),a("td",null,d(t.santri.provinsi),1)],40,it))),128))])])]),e(s).items.length>0?(l(),r("div",vt,[e(s).meta.x_total_data?(l(),w(P,{key:0,meta:e(s).meta,per_page:e(s).params.limit,onSetPage:o[14]||(o[14]=t=>e(s).setPage(t)),onNext:e(s).nexPage,onPrev:e(s).prevPage,onLast:e(s).setPage,onFirst:e(s).setPage},null,8,["meta","per_page","onNext","onPrev","onLast","onFirst"])):m("",!0)])):m("",!0),e(i).contextMenuVisible?(l(),r("div",{key:1,class:"context-menu",style:C({top:`${e(i).contextMenuPosition.y}px`,left:`${e(i).contextMenuPosition.x}px`})},[a("ul",Dt,[a("li",{class:"list-group-item px-5",onClick:o[15]||(o[15]=(...t)=>e(i).handleOpenEditDropspot&&e(i).handleOpenEditDropspot(...t))}," Ubah Dropsot "),a("li",{class:"list-group-item px-5",onClick:o[16]||(o[16]=(...t)=>e(i).handleOpenEditPembayaran&&e(i).handleOpenEditPembayaran(...t))}," Ubah Status Pembayaran "),a("li",{class:"list-group-item px-5",onClick:o[17]||(o[17]=(...t)=>e(i).goToDetail&&e(i).goToDetail(...t))}," Lihat Detail Rombongan ")])],4)):m("",!0),e(i).isOpenEditDropspot===!0?(l(),r("div",{key:2,class:v(["modal fade",{show:e(i).isOpenEditDropspot}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[a("div",Et,[a("div",Pt,[a("div",kt,[xt,a("button",{class:"btn-close",type:"button",onClick:o[18]||(o[18]=(...t)=>e(i).setOpenEditDropspot&&e(i).setOpenEditDropspot(...t))})]),a("form",{onSubmit:o[23]||(o[23]=_((...t)=>e(i).editDropspot&&e(i).editDropspot(...t),["prevent"]))},[a("div",Ot,[a("div",wt,[Ct,p(a("select",{class:"form-select","onUpdate:modelValue":o[19]||(o[19]=t=>e(i).idArea=t),onChange:o[20]||(o[20]=(...t)=>e(i).getDropspot&&e(i).getDropspot(...t))},[St,(l(!0),r(c,null,b(e(i).isArea,t=>(l(),r("option",{key:t,value:t.id},d(t.nama),9,Lt))),128))],544),[[u,e(i).idArea]])]),a("div",Vt,[At,p(a("select",{class:"form-select","onUpdate:modelValue":o[21]||(o[21]=t=>e(i).formEditDropspot.dropspot_id=t),disabled:e(i).idArea===""},[e(i).formEditDropspot.dropspot_id===""?(l(),r("option",Mt," Pilih Dropspot ")):m("",!0),(l(!0),r(c,null,b(e(i).isDropspot,t=>(l(),r("option",{key:t,value:t.id},d(t.nama),9,Ft))),128))],8,Ut),[[u,e(i).formEditDropspot.dropspot_id]])])]),a("div",jt,[a("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:o[22]||(o[22]=(...t)=>e(i).setOpenEditDropspot&&e(i).setOpenEditDropspot(...t))}," Tutup "),Bt])],32)])])],2)):m("",!0),e(i).isOpenEditPembayaran===!0?(l(),r("div",{key:3,class:v(["modal fade",{show:e(i).isOpenEditPembayaran}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[a("div",Tt,[a("div",Nt,[a("div",zt,[Kt,a("button",{class:"btn-close",type:"button",onClick:o[24]||(o[24]=(...t)=>e(i).setOpenEditPembayaran&&e(i).setOpenEditPembayaran(...t))})]),a("form",{onSubmit:o[28]||(o[28]=_((...t)=>e(i).editPembayaran&&e(i).editPembayaran(...t),["prevent"]))},[a("div",$t,[a("div",It,[Rt,p(a("input",{type:"number",class:"form-control mt-2","onUpdate:modelValue":o[25]||(o[25]=t=>e(i).formEditPembayaran.jumlah_bayar=t)},null,512),[[f,e(i).formEditPembayaran.jumlah_bayar]])]),a("div",Wt,[Jt,p(a("select",{class:"form-select","onUpdate:modelValue":o[26]||(o[26]=t=>e(i).formEditPembayaran.status_bayar=t)},Gt,512),[[u,e(i).formEditPembayaran.status_bayar]])])]),a("div",Xt,[a("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:o[27]||(o[27]=(...t)=>e(i).setOpenEditPembayaran&&e(i).setOpenEditPembayaran(...t))}," Tutup "),Yt])],32)])])],2)):m("",!0)],64)}}};export{Zt as default};
