import{m as u,q as l,s,x as o,y as r,z as i,A as h,B as c,C as f,D as g,E as m}from"./index-ddf1c4db.js";const p=u("auth",{state:()=>({token:localStorage.getItem("token")?l():null,user:localStorage.getItem("user")?s():null,nama:localStorage.getItem("nama")?o():null,foto:"",loading:!1,alert:!1}),getters:{isAuth(e){return e.token!==null||e.token!==void 0},getToken:()=>l(),useGetter:()=>s()!==null||s()!==void 0,getNamaLengkap:()=>o()!==null||o()!==void 0,getFotoProfil:()=>r()!==null||r()!==void 0},actions:{async login(e){this.loading=!0;try{await i.post("login",e).then(t=>{h(t.data.token),c(t.data.data),f(t.data.santri.nama_lengkap);const a=l(),n=s(),d=o();a?(this.alert=!0,this.SET_TOKEN_USER(a,n,d),this.loading=!1):(this.loading=!1,g.push("/login"))})}catch(t){console.log("error",t),this.loading=!1}},async getImage(e,t){this.loading=!0;try{const a={responseType:"blob"};await i.get("santri/image/"+e+"?size="+t,a).then(n=>{this.foto=URL.createObjectURL(n.data),this.loading=!1})}catch(a){console.log("error",a),this.loading=!1}},SET_TOKEN_USER(e,t,a){m(e),this.token=e,this.user=t,this.nama=a,g.push("/")}}});export{p as u};
