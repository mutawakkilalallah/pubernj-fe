import{C as y,E as w,I as _,g as k,y as P,a as C,c as m,b as e,j as V,t as i,u as s,k as c,F as h,l as D,d as A,P as f,v as M,o as p,n as x,Q as N}from"./index-31bd0d89.js";const b=y("table_armada_detail",{state:()=>({user:localStorage.getItem("user")?w():null,armada:{},items:[],filter:{area:[],dropspot:[]},meta:{},params:{cari:"",armada:"n",area:"",dropspot:"",jenis_kelamin:"",limit:""}}),actions:{async getData(){const d={params:this.params};try{await _.get("penumpang",d).then(a=>{(a.data.code=200)&&(this.items=a.data.data,this.filter.area=a.data.filter.area,this.meta=a.headers)})}catch{}},async getDropspot(){this.params.dropspot="",this.getData();const d={params:{area:this.params.area}};try{await _.get("dropspot",d).then(a=>{(a.data.code=200)&&(this.filter.dropspot=a.data.data)})}catch{}},async getDataDetail(d){try{await _.get(`armada/${d}`).then(a=>{(a.data.code=200)&&(this.armada=a.data.data)})}catch{}}}}),U=y("form_armada_detail",{state:()=>({formAddArmada:{id_penumpang:[]},formDelArmada:{id_penumpang:[]},lastSelectedIndexAddArmada:null,lastSelectedIndexDelArmada:null}),actions:{handleRowClickAddArmada(d){const a=d;if(event.shiftKey&&this.lastSelectedIndexAddArmada!==null){const o=Math.min(d,this.lastSelectedIndexAddArmada),r=Math.max(d,this.lastSelectedIndexAddArmada);if(a===r)for(let n=o+1;n<=r;n++)this.addIdPenumpangAddArmada(n);else if(a===o)for(let n=o;n+1<=r;n++)this.addIdPenumpangAddArmada(n);else for(let n=o;n<=r;n++)this.addIdPenumpangAddArmada(n)}else this.addIdPenumpangAddArmada(d);this.lastSelectedIndexAddArmada=d},handleRowDelArmada(d){const a=d;if(event.shiftKey&&this.lastSelectedIndexDelArmada!==null){const o=Math.min(d,this.lastSelectedIndexDelArmada),r=Math.max(d,this.lastSelectedIndexDelArmada);if(a===r)for(let n=o+1;n<=r;n++)this.addIdPenumpangDelArmada(n);else if(a===o)for(let n=o;n+1<=r;n++)this.addIdPenumpangDelArmada(n);else for(let n=o;n<=r;n++)this.addIdPenumpangDelArmada(n)}else this.addIdPenumpangDelArmada(d);this.lastSelectedIndexDelArmada=d},addIdPenumpangAddArmada(d){const a=this.formAddArmada.id_penumpang.indexOf(d);a==-1?this.formAddArmada.id_penumpang.push(d):this.formAddArmada.id_penumpang.splice(a,1)},addIdPenumpangDelArmada(d){const a=this.formDelArmada.id_penumpang.indexOf(d);a===-1?this.formDelArmada.id_penumpang.push(d):this.formDelArmada.id_penumpang.splice(a,1)},dragStartAddArmada(d){this.formAddArmada.id_penumpang.push(d)},allowDropAddArmada(d){d.preventDefault()},dropAddArmada(d,a){console.log(a),d.preventDefault(),this.hitAddArmada(this.formAddArmada,a),this.formAddArmada.id_penumpang=[]},dragStartDellArmada(d){this.formDelArmada.id_penumpang.push(d)},allowDropDelArmada(d){d.preventDefault()},dropDelArmada(d,a){d.preventDefault(),this.hitDelArmada(this.formDelArmada,a),this.formDelArmada.id_penumpang=[]},async hitAddArmada(d,a){try{await _.put(`penumpang/armada/${a}`,d).then(o=>{const r=b();r.getData(),r.getDataDetail(a)})}catch{}},async hitDelArmada(d,a){try{await _.put("penumpang/armada/delete",d).then(o=>{const r=b();r.getData(),r.getDataDetail(a)})}catch{}}}}),T=e("h3",null,"Pengelolaan Data Penumpang",-1),$=e("hr",null,null,-1),B={class:"row"},K={class:"col-md-6"},L={class:"row"},R={class:"col-md-2"},j={class:"col-md-8"},E=e("hr",null,null,-1),F={class:"mb-1"},z=e("b",null,"Dropspot : ",-1),H=e("p",{class:"mb-1"},[e("b",null,"Pendamping : "),c("-")],-1),J=e("p",{class:"mb-1"},[e("b",null,"No. HP : "),c("-")],-1),O=e("hr",null,null,-1),Q={class:"mb-1"},W=e("b",null,"Jumlah Penumpang : ",-1),q=e("hr",null,null,-1),G={class:"badge bg-success"},X={class:"table-responsive"},Y=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"No"),e("th",{scope:"col"},"Nama"),e("th",{scope:"col"},"Dropspot")])],-1),Z=["onDragstart","onClick"],aa={class:"col-md-6"},ea={class:"filter-box mb-5 row"},ta={class:"col-md-4"},sa=e("option",{value:"",selected:""},"Semua Area",-1),da=["value"],oa=["disabled"],la=e("option",{value:"",selected:""},"Semua Dropsot",-1),na=["value"],ra={class:"col-md-4"},ia=e("option",{value:"",selected:""},"Semua Jenis Kelamin",-1),ma=e("option",{value:"L",selected:""},"Laki-laki",-1),pa=e("option",{value:"P",selected:""},"Perempuan",-1),ca=[ia,ma,pa],ua=N('<option value="" selected>Limit by Kapasitas</option><option value="60" selected>BUS (60)</option><option value="34" selected>Mini Bus (34)</option><option value="18" selected>ELF (18)</option><option value="13" selected>HIACE (13)</option><option value="7" selected>MPV (8)</option>',6),ha=[ua],Aa={class:"serach-box row"},_a={class:"col-md-8 d-flex align-items-center mb-2"},ga={class:"col-md-4 d-flex align-items-center"},Da=e("hr",null,null,-1),fa={class:"badge bg-success"},va={class:"table-responsive"},ba=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"No"),e("th",{scope:"col"},"Nama"),e("th",{scope:"col"},"Wilayah")])],-1),xa=["onDragstart","onClick"],Ia={__name:"DetailPage",setup(d){const a=b(),o=U(),r=k(),n=g=>o.formAddArmada.id_penumpang.includes(g),I=g=>o.formDelArmada.id_penumpang.includes(g);return P(()=>{a.getData(),a.getDataDetail(r.params.id)}),(g,l)=>{const S=C("font-awesome-icon");return p(),m(h,null,[T,$,e("div",B,[e("div",K,[e("div",L,[e("div",R,[V(S,{icon:"bus",class:"icon",style:{"font-size":"100px"}})]),e("div",j,[e("h3",null,i(s(a).armada.nama),1),E,e("p",F,[z,c(i(s(a).armada.dropspot?s(a).armada.dropspot.nama:"-"),1)]),H,J,O,e("p",Q,[W,c(i(s(a).armada.penumpang?s(a).armada.penumpang.length:0),1)])])]),q,c(" Total "),e("p",G,i(s(o).formDelArmada.id_penumpang.length),1),c(" item dipilih "),e("div",X,[e("table",{class:"table table-sm table-hover mt-3",onDragover:l[0]||(l[0]=(...t)=>s(o).allowDropAddArmada&&s(o).allowDropAddArmada(...t)),onDrop:l[1]||(l[1]=t=>s(o).dropAddArmada(t,s(r).params.id))},[Y,e("tbody",null,[(p(!0),m(h,null,D(s(a).armada.penumpang,(t,u)=>(p(),m("tr",{key:u,draggable:"true",onDragstart:v=>s(o).dragStartDellArmada(t.id),onClick:v=>s(o).handleRowDelArmada(t.id),class:x({"table-active":I(t.id)})},[e("td",null,i(u+1),1),e("td",null,i(t.santri.nama_lengkap),1),e("td",null,i(t.dropspot?t.dropspot.nama:"-"),1)],42,Z))),128))])],32)])]),e("div",aa,[e("div",ea,[e("div",ta,[A(e("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[2]||(l[2]=t=>s(a).params.area=t),onChange:l[3]||(l[3]=(...t)=>s(a).getDropspot&&s(a).getDropspot(...t))},[sa,(p(!0),m(h,null,D(s(a).filter.area,t=>(p(),m("option",{key:t,value:t.id},i(t.nama),9,da))),128))],544),[[f,s(a).params.area]]),A(e("select",{class:"form-select form-select-sm mb-2",disabled:s(a).params.area==="","onUpdate:modelValue":l[4]||(l[4]=t=>s(a).params.dropspot=t),onChange:l[5]||(l[5]=(...t)=>s(a).getData&&s(a).getData(...t))},[la,(p(!0),m(h,null,D(s(a).filter.dropspot,t=>(p(),m("option",{key:t,value:t.id},i(t.nama),9,na))),128))],40,oa),[[f,s(a).params.dropspot]])]),e("div",ra,[A(e("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[6]||(l[6]=t=>s(a).params.jenis_kelamin=t),onChange:l[7]||(l[7]=(...t)=>s(a).getData&&s(a).getData(...t))},ca,544),[[f,s(a).params.jenis_kelamin]]),A(e("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[8]||(l[8]=t=>s(a).params.limit=t),onChange:l[9]||(l[9]=(...t)=>s(a).getData&&s(a).getData(...t))},ha,544),[[f,s(a).params.limit]])])]),e("div",Aa,[e("div",_a,[e("small",null,"Total data "+i(s(a).meta.x_total_data),1)]),e("div",ga,[A(e("input",{type:"text","onUpdate:modelValue":l[10]||(l[10]=t=>s(a).params.cari=t),class:"form-control form-control-sm mb-2",placeholder:"Cari Santri ...",onKeyup:l[11]||(l[11]=(...t)=>s(a).getData&&s(a).getData(...t))},null,544),[[M,s(a).params.cari]])])]),Da,c(" Total "),e("p",fa,i(s(o).formAddArmada.id_penumpang.length),1),c(" item dipilih "),e("div",va,[e("table",{class:"table table-sm table-hover mt-3",onDragover:l[12]||(l[12]=(...t)=>s(o).allowDropDelArmada&&s(o).allowDropDelArmada(...t)),onDrop:l[13]||(l[13]=t=>s(o).dropDelArmada(t,s(r).params.id))},[ba,e("tbody",null,[(p(!0),m(h,null,D(s(a).items,(t,u)=>(p(),m("tr",{key:u,draggable:"true",onDragstart:v=>s(o).dragStartAddArmada(t.id),onClick:v=>s(o).handleRowClickAddArmada(t.id),class:x({"table-active":n(t.id)})},[e("td",null,i(u+1),1),e("td",null,i(t.santri.nama_lengkap),1),e("td",null,i(t.santri.wilayah),1)],42,xa))),128))])],32)])])])],64)}}};export{Ia as default};
