import{x as D,C as c,S,a as v,g as n,c as r,b as t,d as m,E as p,u as s,F as u,s as h,t as d,v as _,e as f,z as b,n as k,l as C,q as O,m as V,w as A,G as U}from"./index-47bc540a.js";import{u as L}from"./index-662c665e.js";const w=D("table_santri",{state:()=>({isOpenDetail:!1,items:[],item:{},fotoDiri:"",meta:{},myPage:"",filter:{wilayah:[],blok:[]},uuid:"",params:{cari:"",wilayah:"",blok:"",status_kepulangan:"",jenis_kelamin:"",page:1,limit:25}}),actions:{nexPage(l){this.params.page=parseInt(l)+1,this.getData()},prevPage(l){this.params.page=parseInt(l)-1,this.getData()},setPage(l){this.params.page=parseInt(l),this.getData()},searchPage(){this.params.page=1,this.getData()},async getData(){const l={params:this.params};try{await c.get("santri",l).then(a=>{(a.data.code=200)&&(this.items=a.data.data,this.meta=a.headers)})}catch{}},async handleDoubelClick(l){this.uuid=l;try{this.isOpenDetail=!0,await c.get("santri/"+l).then(a=>{(a.data.code=200)&&(this.item=a.data.data,this.getImage(a.data.data.niup,"medium"))})}catch{}},async handleReset(){this.params={cari:"",wilayah:"",blok:"",status_kepulangan:"",jenis_kelamin:"",page:1,limit:25},this.getData()},async getImage(l){try{const a={responseType:"blob"};await c.get("santri/image/"+l,a).then(i=>{this.fotoDiri=URL.createObjectURL(i.data)})}catch{}},async getWilayah(){try{await c.get("santri/filter/wilayah").then(l=>{(l.data.code=200)&&(this.filter.wilayah=l.data)})}catch{}},async getBlok(){this.params.blok="",this.getData();try{await c.get(`santri/filter/blok?alias_wilayah=${this.params.wilayah}`).then(l=>{(l.data.code=200)&&(this.filter.blok=l.data)})}catch{}}}}),N=D("form_santri",{state:()=>({isOpenEdit:!1,idArea:"",isArea:[],isDropspot:[],formEditDropspot:{dropspot_id:""}}),actions:{setOpenEdit(){this.isOpenEdit=!this.isOpenEdit},getArea(){try{c.get("area").then(l=>{this.isArea=l.data.data})}catch{}},async getDropspot(){this.formEditDropspot.dropspot_id="";const l={params:{area:this.idArea}};try{await c.get("dropspot",l).then(a=>{this.isDropspot=a.data.data})}catch{}},async editData(){const l=w();try{await c.post(`santri/daftar/${l.uuid}`,this.formEditDropspot).then(a=>{this.isOpenEdit=!1,this.formEditDropspot.dropspot_id="",this.idArea="",l.uuid="",l.isOpenDetail=!1,l.getData()})}catch(a){S.fire(a.response.data.message,a.response.data.error,"error")}}}}),R=t("h3",{class:"titlePage"},"Data Santri",-1),T=t("hr",null,null,-1),K={class:"filter-box row"},j={class:"col-md-2"},B=t("option",{value:"",selected:""},"Semua Wilayah",-1),$=["value"],I=["disabled"],F=t("option",{value:"",selected:""},"Semua Daerah",-1),W=["value"],z={class:"col-md-2"},M=t("option",{value:"",selected:""},"Semua Status Kepulangan",-1),J=t("option",{value:"rombongan"},"Rombongan",-1),q=t("option",{value:"non-rombongan"},"Non Rombongan",-1),G=[M,J,q],H=t("option",{value:"",selected:""},"Semua Jenis Kelamin",-1),Q=t("option",{value:"L"},"Laki-Laki",-1),X=t("option",{value:"P"},"Perempuan",-1),Y=[H,Q,X],Z={class:"serach-box row mt-2"},tt={class:"col-md-6 mb-2 d-flex"},at={class:"col-sm-3 col-md-1 me-3"},st=U('<option value="25" selected>25</option><option value="50">50</option><option value="100">100</option><option value="250">250</option><option value="500">500</option><option value="1000">1000</option>',6),et=[st],ot={class:"col-sm-9 col-md-11"},lt={class:"col-md-6 mb-2"},it={class:"row justify-content-end"},nt={class:"col-md-3"},rt={class:"col-auto d-flex flex-column align-items-end"},dt={class:"table-responsive"},mt={class:"table table-sm table-hover mt-3"},ct=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"No"),t("th",{scope:"col"},"NIUP"),t("th",{scope:"col"},"Nama Lengkap"),t("th",{scope:"col"},"JK"),t("th",{scope:"col"},"Wilayah"),t("th",{scope:"col"},"Daerah"),t("th",{scope:"col"},"Kab/Kota"),t("th",{scope:"col"},"Status Kepulangan")])],-1),pt=["onDblclick"],ut={key:0,class:"text-capitalize"},_t={class:"badge bg-danger"},ht={key:1,class:"text-capitalize"},bt={class:"badge bg-success"},gt={class:"modal-dialog"},vt={class:"modal-content"},yt={class:"modal-header"},ft=t("h1",{class:"modal-title fs-5",id:"modalDetailLabel"},"Detail Santri",-1),kt={class:"modal-body"},Dt={class:"alert alert-secondary p-1 fs-6",role:"alert"},wt={class:"row"},xt={class:"col-md-8 order-sm-2 order-md-2"},Et={class:"mb-3 row"},Pt=t("label",{class:"col-sm-4 col-form-label"},"NIUP",-1),St={class:"col-sm-8"},Ct={class:"mb-3 row"},Ot=t("label",{class:"col-sm-4 col-form-label"},"Nama Lengkap",-1),Vt={class:"col-sm-8"},At={class:"mb-3 row"},Ut=t("label",{class:"col-sm-4 col-form-label"},"Tanggal Lahir",-1),Lt={class:"col-sm-8"},Nt=["value"],Rt={class:"mb-3 row"},Tt=t("label",{class:"col-sm-4 col-form-label"},"Wilayah",-1),Kt={class:"col-sm-8"},jt={class:"mb-3 row"},Bt=t("label",{class:"col-sm-4 col-form-label"},"Daerah",-1),$t={class:"col-sm-8"},It={class:"mb-3 row"},Ft=t("label",{class:"col-sm-4 col-form-label"},"Kamar",-1),Wt={class:"col-sm-8"},zt={class:"mb-3 row"},Mt=t("label",{class:"col-sm-4 col-form-label"},"Kecamatan",-1),Jt={class:"col-sm-8"},qt=["value"],Gt={class:"mb-3 row"},Ht=t("label",{class:"col-sm-4 col-form-label"},"Kabupaten",-1),Qt={class:"col-sm-8"},Xt=["value"],Yt={class:"mb-3 row"},Zt=t("label",{class:"col-sm-4 col-form-label"},"Provinsi",-1),ta={class:"col-sm-8"},aa=["value"],sa={class:"col-md-4 order-sm-1 order-md-2 mb-5 text-end"},ea=["src"],oa={class:"modal-footer"},la={class:"modal-dialog"},ia={class:"modal-content"},na={class:"modal-header"},ra=t("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit Dropsot",-1),da={class:"modal-body"},ma={class:"form-group mb-3"},ca=t("small",null,"Area",-1),pa=t("option",{value:"",selected:""},"Pilih Area",-1),ua=["value"],_a={class:"form-group mb-3"},ha=t("small",null,"Dropspot",-1),ba=["disabled"],ga={key:0,value:"",selected:""},va=["value"],ya={class:"modal-footer"},fa=t("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),Ea={__name:"SantriPage",setup(l){const a=w(),i=N(),g=L();return i.getArea(),a.getData(),a.getWilayah(),(ka,o)=>{const x=v("app-paginate"),E=v("font-awesome-icon"),P=v("router-link");return n(),r(u,null,[R,T,t("div",K,[t("div",j,[m(t("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[0]||(o[0]=e=>s(a).params.wilayah=e),onChange:o[1]||(o[1]=(...e)=>s(a).getBlok&&s(a).getBlok(...e))},[B,(n(!0),r(u,null,h(s(a).filter.wilayah,e=>(n(),r("option",{key:e,value:e.alias_wilayah},d(e.wilayah),9,$))),128))],544),[[p,s(a).params.wilayah]]),m(t("select",{class:"form-select form-select-sm mb-2",disabled:s(a).params.wilayah==="","onUpdate:modelValue":o[2]||(o[2]=e=>s(a).params.blok=e),onChange:o[3]||(o[3]=(...e)=>s(a).getData&&s(a).getData(...e))},[F,(n(!0),r(u,null,h(s(a).filter.blok,e=>(n(),r("option",{key:e,value:e.id_blok},d(e.blok),9,W))),128))],40,I),[[p,s(a).params.blok]])]),t("div",z,[m(t("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[4]||(o[4]=e=>s(a).params.status_kepulangan=e),onChange:o[5]||(o[5]=(...e)=>s(a).getData&&s(a).getData(...e))},G,544),[[p,s(a).params.status_kepulangan]]),m(t("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[6]||(o[6]=e=>s(a).params.jenis_kelamin=e),onChange:o[7]||(o[7]=(...e)=>s(a).getData&&s(a).getData(...e))},Y,544),[[p,s(a).params.jenis_kelamin]])])]),t("div",Z,[t("div",tt,[t("div",at,[m(t("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[8]||(o[8]=e=>s(a).params.limit=e),onChange:o[9]||(o[9]=(...e)=>s(a).getData&&s(a).getData(...e))},et,544),[[p,s(a).params.limit]])]),t("div",ot,[t("small",null,"Total data "+d(s(a).meta.x_total_data),1)])]),t("div",lt,[t("div",it,[t("div",nt,[m(t("input",{type:"text","onUpdate:modelValue":[o[10]||(o[10]=e=>s(a).params.cari=e),o[11]||(o[11]=(...e)=>s(a).searchPage&&s(a).searchPage(...e))],class:"form-control form-control-sm mb-2",placeholder:"Cari Santri ..."},null,512),[[_,s(a).params.cari]])]),t("div",rt,[t("button",{class:"btn btn-danger btn-sm",onClick:o[12]||(o[12]=(...e)=>s(a).handleReset&&s(a).handleReset(...e))}," RESET ")])])])]),t("div",dt,[t("table",mt,[ct,t("tbody",null,[(n(!0),r(u,null,h(s(a).items,(e,y)=>(n(),r("tr",{style:{cursor:"pointer"},key:y,onDblclick:Da=>s(a).handleDoubelClick(e.uuid)},[t("td",null,d(y+1+(s(a).params.page-1)*s(a).params.limit),1),t("td",null,d(e.niup),1),t("td",null,d(e.nama_lengkap),1),t("td",null,d(e.jenis_kelamin),1),t("td",null,d(e.wilayah?e.wilayah:"-"),1),t("td",null,d(e.blok?e.blok:"-"),1),t("td",null,d(e.kabupaten),1),e.status_kepulangan==="non-rombongan"?(n(),r("td",ut,[t("small",_t,d(e.status_kepulangan),1)])):(n(),r("td",ht,[t("small",bt,d(e.status_kepulangan),1)]))],40,pt))),128))])])]),s(a).meta.x_total_data?(n(),f(x,{key:0,meta:s(a).meta,per_page:s(a).params.limit,onSetPage:o[13]||(o[13]=e=>s(a).setPage(e)),onNext:s(a).nexPage,onPrev:s(a).prevPage,onLast:s(a).setPage,onFirst:s(a).setPage},null,8,["meta","per_page","onNext","onPrev","onLast","onFirst"])):b("",!0),s(a).isOpenDetail===!0?(n(),r("div",{key:1,class:k(["modal fade modal-lg",{show:s(a).isOpenDetail}]),style:{display:"block"},id:"modalDetail",tabindex:"-1","aria-labelledby":"modalDetailLabel","aria-hidden":"true"},[t("div",gt,[t("div",vt,[t("div",yt,[ft,t("button",{class:"btn-close",type:"button",onClick:o[14]||(o[14]=e=>s(a).isOpenDetail=!1)})]),t("div",kt,[t("p",Dt,[t("i",null,[C(E,{icon:"bell",class:"icon"}),O(" Data santri hanya bersifat temporary sebagai kebutuhan Pulang Bersama, untuk data lebih detail silahkan lihat di Aplikasi PEDATREN")])]),t("div",wt,[t("div",xt,[t("div",Et,[Pt,t("div",St,[m(t("input",{type:"text",readonly:"",class:"form-control-plaintext","onUpdate:modelValue":o[15]||(o[15]=e=>s(a).item.niup=e)},null,512),[[_,s(a).item.niup]])])]),t("div",Ct,[Ot,t("div",Vt,[m(t("input",{type:"text",readonly:"",class:"form-control-plaintext","onUpdate:modelValue":o[16]||(o[16]=e=>s(a).item.nama_lengkap=e)},null,512),[[_,s(a).item.nama_lengkap]])])]),t("div",At,[Ut,t("div",Lt,[t("input",{type:"text",readonly:"",class:"form-control-plaintext",value:s(a).item.raw.tempat_lahir+", "+s(a).item.raw.tanggal_lahir},null,8,Nt)])]),t("div",Rt,[Tt,t("div",Kt,[m(t("input",{type:"text",readonly:"",class:"form-control-plaintext","onUpdate:modelValue":o[17]||(o[17]=e=>s(a).item.wilayah=e)},null,512),[[_,s(a).item.wilayah]])])]),t("div",jt,[Bt,t("div",$t,[m(t("input",{type:"text",readonly:"",class:"form-control-plaintext","onUpdate:modelValue":o[18]||(o[18]=e=>s(a).item.blok=e)},null,512),[[_,s(a).item.blok]])])]),t("div",It,[Ft,t("div",Wt,[m(t("input",{type:"text",readonly:"",class:"form-control-plaintext","onUpdate:modelValue":o[19]||(o[19]=e=>s(a).item.raw.domisili_santri[s(a).item.raw.domisili_santri.length-1].kamar=e)},null,512),[[_,s(a).item.raw.domisili_santri[s(a).item.raw.domisili_santri.length-1].kamar]])])]),t("div",zt,[Mt,t("div",Jt,[t("input",{type:"text",readonly:"",class:"form-control-plaintext",value:s(a).item.raw.kecamatan},null,8,qt)])]),t("div",Gt,[Ht,t("div",Qt,[t("input",{type:"text",readonly:"",class:"form-control-plaintext",value:s(a).item.raw.kabupaten},null,8,Xt)])]),t("div",Yt,[Zt,t("div",ta,[t("input",{type:"text",readonly:"",class:"form-control-plaintext",value:s(a).item.raw.provinsi},null,8,aa)])])]),t("div",sa,[t("img",{src:s(a).fotoDiri,alt:"foto-diri",class:"img-thumbnail"},null,8,ea)])])]),t("div",oa,[s(a).item.status_kepulangan==="rombongan"?(n(),f(P,{key:0,to:{name:"penumpang-detail",params:{uuid:s(a).item.uuid}}},{default:V(()=>[t("button",{class:"btn btn-primary",type:"button",onClick:o[20]||(o[20]=e=>s(a).isOpenDetail=!1)}," Lihat Data Rombongan ")]),_:1},8,["to"])):s(a).item.status_kepulangan==="rombongan"&&s(g).user.role!="keuangan"&&s(g).user.role!="armada"&&s(g).user.role!="p4nj"&&s(g).user.role!="supervisor"?(n(),r("button",{key:1,class:"btn btn-primary",type:"button",onClick:o[21]||(o[21]=e=>s(i).isOpenEdit=!0)}," Daftarkan Rombongan ")):b("",!0),t("button",{type:"button",class:"btn btn-secondary",onClick:o[22]||(o[22]=e=>s(a).isOpenDetail=!1)}," Tutup ")])])])],2)):b("",!0),s(i).isOpenEdit===!0?(n(),r("div",{key:2,class:k(["modal fade",{show:s(i).isOpenEdit}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[t("div",la,[t("div",ia,[t("div",na,[ra,t("button",{class:"btn-close",type:"button",onClick:o[23]||(o[23]=(...e)=>s(i).setOpenEdit&&s(i).setOpenEdit(...e))})]),t("form",{onSubmit:o[28]||(o[28]=A(e=>s(i).editData(),["prevent"]))},[t("div",da,[t("div",ma,[ca,m(t("select",{class:"form-select","onUpdate:modelValue":o[24]||(o[24]=e=>s(i).idArea=e),onChange:o[25]||(o[25]=(...e)=>s(i).getDropspot&&s(i).getDropspot(...e))},[pa,(n(!0),r(u,null,h(s(i).isArea,e=>(n(),r("option",{key:e,value:e.id},d(e.nama),9,ua))),128))],544),[[p,s(i).idArea]])]),t("div",_a,[ha,m(t("select",{class:"form-select","onUpdate:modelValue":o[26]||(o[26]=e=>s(i).formEditDropspot.dropspot_id=e),disabled:s(i).idArea===""},[s(i).formEditDropspot.dropspot_id===""?(n(),r("option",ga," Pilih Dropspot ")):b("",!0),(n(!0),r(u,null,h(s(i).isDropspot,e=>(n(),r("option",{key:e,value:e.id},d(e.nama),9,va))),128))],8,ba),[[p,s(i).formEditDropspot.dropspot_id]])])]),t("div",ya,[t("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:o[27]||(o[27]=(...e)=>s(i).setOpenEdit&&s(i).setOpenEdit(...e))}," Tutup "),fa])],32)])])],2)):b("",!0)],64)}}};export{Ea as default};
