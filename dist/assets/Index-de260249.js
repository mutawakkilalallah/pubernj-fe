import{m as E,z as h,S as u,a as P,c as n,b as s,d as m,I as k,u as e,F as c,j as b,t as r,v as p,n as y,h as O,G as v,o as d}from"./index-dca10e1d.js";const f=E("table_user",{state:()=>({roles:[],items:[],params:{cari:"",role:""}}),actions:{async getData(){const i={params:this.params};try{await h.get("user",i).then(l=>{(l.data.code=200)&&(this.items=l.data.data,this.roles=l.data.filter.role)})}catch{}}}}),U=E("form_user",{state:()=>({isOpenAdd:!1,isOpenEdit:!1,isOpenEditPassword:!1,isOpenPilihUser:!1,isArea:[],santriUser:[],idEdit:"",roleValue:"",namaSantri:"",cariSantri:"",form:{santri_uuid:"",username:"",role:"",password:""},formEdit:{santri_uuid:"",username:"",role:""},formEditPassword:{password:""}}),actions:{setOpenAdd(){this.isOpenAdd=!this.isOpenAdd},setOpenEdit(){this.isOpenEdit=!this.isOpenEdit},setOpenEditPassword(){this.isOpenEditPassword=!this.isOpenEditPassword},setOpenPilihUser(){this.isOpenPilihUser=!this.isOpenPilihUser},async tambahData(){try{const i=await h.post("user",this.form);this.isOpenAdd=!1,u.fire("Berhasil",i.data.message,"success"),f().getData(),this.form={},this.namaSantri=""}catch(i){u.fire(i.response.data.message,i.response.data.error,"error")}},async getSantri(){try{const i={cari:this.cariSantri};await h.get("santri",{params:i}).then(l=>{(l.data.code=200)&&(this.santriUser=l.data.data)})}catch{u.fire(err.response.data.message,err.response.data.error,"error")}},handleDoubleClik(i){this.idEdit=i.id,this.roleValue=i.role?i.role:"kosong",this.formEdit.santri_uuid=i.santri_uuid,this.formEdit.role=i.role,this.formEdit.username=i.username,this.isOpenEdit=!0},handleChangePassword(i){this.idEdit=i.id,this.formEdit.password=null,this.isOpenEditPassword=!0},handleOpenPilihUser(){this.isOpenPilihUser=!0},handleUserPilih(i,l){this.form.santri_uuid=i,this.namaSantri=l,this.cariSantri="",this.isOpenPilihUser=!1},async editData(){try{await h.put(`user/${this.idEdit}`,this.formEdit).then(i=>{this.isOpenEdit=!1,this.formEdit={},u.fire("Berhasil",i.data.message,"success"),f().getData()})}catch(i){u.fire(i.response.data.message,i.response.data.error,"error")}},async editDataPassword(){try{await h.put(`user/password/${this.idEdit}`,this.formEditPassword).then(i=>{this.isOpenEditPassword=!1,this.formEditPassword={},u.fire("Berhasil",i.data.message,"success"),f().getData()})}catch(i){u.fire(i.response.data.message,i.response.data.error,"error")}},async deleteData(){u.fire({title:"Konfirmasi",text:"Apakah anda yakin ingin menghapus data ?",icon:"info",showCancelButton:!0,confirmButtonText:"Hapus",confirmButtonColor:"#DC3545"}).then(i=>{i.isConfirmed&&h.delete(`user/${this.idEdit}`).then(l=>{this.isOpenEdit=!1,u.fire("Berhasil",l.data.message,"success"),this.form={},f().getData()})})}}}),D=s("h3",null,"Data User",-1),C=s("hr",null,null,-1),S={class:"filter-box mb-5 row"},x={class:"col-md-2"},A=s("option",{value:"",selected:""},"Semua Hak Akses",-1),V=["value"],$={class:"serach-box row"},T={class:"col-md-10 d-flex align-items-center mb-2"},B={class:"col-md-2 d-flex align-items-center"},L=s("hr",null,null,-1),N={class:"table-responsive"},H={class:"table table-sm table-hover mt-3"},M=s("thead",null,[s("tr",null,[s("th",{scope:"col"},"No"),s("th",{scope:"col"},"Nama"),s("th",{scope:"col"},"Username"),s("th",{scope:"col"},"Hak Akses"),s("th",{scope:"col"},"Daerah"),s("th",{scope:"col"})])],-1),F=["onDblclick"],I=["onClick"],K={class:"modal-dialog"},z={class:"modal-content"},j={class:"modal-header"},G=s("h1",{class:"modal-title fs-5",id:"modalTambahLabel"},"Tambah User",-1),W={class:"modal-body"},q={class:"form-group mb-3"},J={class:"input-group mb-3"},Q={class:"input-group-append"},R={class:"form-group mb-3"},X=s("small",null,"Hak Akses",-1),Y=s("option",{value:"",selected:""},"Pilih Hak Akses",-1),Z=["value"],ss={class:"form-group mb-3"},ts=s("small",null,"Username",-1),es={class:"form-group mb-3"},as=s("small",null,"Password",-1),os={class:"modal-footer"},is={class:"modal-dialog"},ls={class:"modal-content"},ns={class:"modal-header"},ds=s("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit User",-1),rs={class:"modal-body"},ms={class:"form-group mb-3"},us=s("small",null,"Username",-1),ps={class:"form-group mb-3"},cs=s("small",null,"Hak Akses",-1),hs=["value"],bs={class:"modal-footer"},fs={class:"modal-dialog"},_s={class:"modal-content"},ys={class:"modal-header"},vs=s("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Update Password",-1),ks={class:"modal-body"},ws={class:"form-group mb-3"},Es=s("small",null,"Password",-1),gs={class:"modal-footer"},Ps={class:"modal-dialog"},Os={class:"modal-content"},Us={class:"modal-header"},Ds=s("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Pilih User",-1),Cs={class:"modal-body"},Ss={class:"form-group mb-3"},xs=s("p",null,"Pilih Santri",-1),As=s("hr",null,null,-1),Vs={class:"table-responsive"},$s={class:"table table-sm table-hover mt-3"},Ts=s("thead",null,[s("tr",null,[s("th",{scope:"col"},"NIUP"),s("th",{scope:"col"},"Nama"),s("th",{scope:"col"},"Wilayah"),s("th",{scope:"col"},"Daerah")])],-1),Bs=["onDblclick"],Ls={class:"modal-footer"},Ms={__name:"Index",setup(i){const l=f(),o=U();return l.getData(),(Ns,a)=>{const g=P("font-awesome-icon");return d(),n(c,null,[D,C,s("div",S,[s("div",x,[m(s("select",{class:"form-select form-select-sm","onUpdate:modelValue":a[0]||(a[0]=t=>e(l).params.role=t),onChange:a[1]||(a[1]=(...t)=>e(l).getData&&e(l).getData(...t))},[A,(d(!0),n(c,null,b(e(l).roles,t=>(d(),n("option",{key:t,value:t.key},r(t.value),9,V))),128))],544),[[k,e(l).params.role]])])]),s("div",$,[s("div",T,[s("small",null,"Total data "+r(e(l).items.length),1)]),s("div",B,[m(s("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=t=>e(l).params.cari=t),class:"form-control form-control-sm mb-2",placeholder:"Cari User ...",onKeyup:a[3]||(a[3]=(...t)=>e(l).getData&&e(l).getData(...t))},null,544),[[p,e(l).params.cari]])])]),L,s("button",{class:"btn btn-sm btn-primary",onClick:a[4]||(a[4]=(...t)=>e(o).setOpenAdd&&e(o).setOpenAdd(...t))}," Tambah User "),s("div",N,[s("table",H,[M,s("tbody",null,[(d(!0),n(c,null,b(e(l).items,(t,_)=>(d(),n("tr",{key:_,onDblclick:w=>e(o).handleDoubleClik(t)},[s("td",null,r(_+1),1),s("td",null,r(t.santri_nama),1),s("td",null,r("@"+t.username),1),s("td",null,r(t.role),1),s("td",null,r(t.raw.domisili_santri[t.raw.domisili_santri.length-1].blok),1),s("td",null,[s("button",{onClick:w=>e(o).handleChangePassword(t),class:"btn btn-sm btn-primary"}," Ubah Password ",8,I)])],40,F))),128))])])]),e(o).isOpenAdd===!0?(d(),n("div",{key:0,class:y(["modal fade",{show:e(o).isOpenAdd}]),style:{display:"block"},id:"modalTambah",tabindex:"-1","aria-labelledby":"modalTambahLabel","aria-hidden":"true"},[s("div",K,[s("div",z,[s("div",j,[G,s("button",{class:"btn-close",type:"button",onClick:a[5]||(a[5]=t=>e(o).isOpenAdd=!1)})]),s("div",W,[m(s("input",{type:"hidden","onUpdate:modelValue":a[6]||(a[6]=t=>e(o).form.santri_uuid=t)},null,512),[[p,e(o).form.santri_uuid]]),s("div",q,[s("div",J,[m(s("input",{type:"text","onUpdate:modelValue":a[7]||(a[7]=t=>e(o).namaSantri=t),class:"form-control",placeholder:"Pilih Santri ..",disabled:"",readonly:"","aria-describedby":"basic-addon2"},null,512),[[p,e(o).namaSantri]]),s("div",Q,[s("button",{class:"btn btn-outline-secondary",onClick:a[8]||(a[8]=(...t)=>e(o).setOpenPilihUser&&e(o).setOpenPilihUser(...t)),type:"button"},[O(g,{icon:"pen-alt"})])])])]),s("div",R,[X,m(s("select",{class:"form-select","onUpdate:modelValue":a[9]||(a[9]=t=>e(o).form.role=t)},[Y,(d(!0),n(c,null,b(e(l).roles,t=>(d(),n("option",{key:t.key,value:t.key},r(t.value),9,Z))),128))],512),[[k,e(o).form.role]])]),s("div",ss,[ts,m(s("input",{type:"text","onUpdate:modelValue":a[10]||(a[10]=t=>e(o).form.username=t),placeholder:"Masukkan username ..",class:"form-control mt-2"},null,512),[[p,e(o).form.username]])]),s("div",es,[as,m(s("input",{type:"password","onUpdate:modelValue":a[11]||(a[11]=t=>e(o).form.password=t),placeholder:"Masukkan password ..",class:"form-control mt-2"},null,512),[[p,e(o).form.password]])])]),s("div",os,[s("button",{class:"btn btn-sm btn-secondary",onClick:a[12]||(a[12]=t=>e(o).isOpenAdd=!1)}," Tutup "),s("button",{class:"btn btn-sm btn-primary",onClick:a[13]||(a[13]=(...t)=>e(o).tambahData&&e(o).tambahData(...t))}," Simpan ")])])])],2)):v("",!0),e(o).isOpenEdit===!0?(d(),n("div",{key:1,class:y(["modal fade",{show:e(o).isOpenEdit}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[s("div",is,[s("div",ls,[s("div",ns,[ds,s("button",{class:"btn-close",type:"button",onClick:a[14]||(a[14]=t=>e(o).isOpenEdit=!1)})]),s("div",rs,[m(s("input",{type:"hidden","onUpdate:modelValue":a[15]||(a[15]=t=>e(o).formEdit.santri_uuid=t)},null,512),[[p,e(o).formEdit.santri_uuid]]),s("div",ms,[us,m(s("input",{type:"text","onUpdate:modelValue":a[16]||(a[16]=t=>e(o).formEdit.username=t),placeholder:"Masukkan username ..",class:"form-control mt-2"},null,512),[[p,e(o).formEdit.username]])]),s("div",ps,[cs,m(s("select",{class:"form-select","onUpdate:modelValue":a[17]||(a[17]=t=>e(o).formEdit.role=t)},[(d(!0),n(c,null,b(e(l).roles,t=>(d(),n("option",{key:t.key,value:t.key},r(t.value),9,hs))),128))],512),[[k,e(o).formEdit.role]])])]),s("div",bs,[s("button",{class:"btn btn-sm btn-secondary",onClick:a[18]||(a[18]=t=>e(o).isOpenEdit=!1)}," Tutup "),s("button",{class:"btn btn-sm btn-danger",onClick:a[19]||(a[19]=(...t)=>e(o).deleteData&&e(o).deleteData(...t))}," Hapus "),s("button",{class:"btn btn-sm btn-primary",onClick:a[20]||(a[20]=(...t)=>e(o).editData&&e(o).editData(...t))}," Simpan ")])])])],2)):v("",!0),e(o).isOpenEditPassword===!0?(d(),n("div",{key:2,class:y(["modal fade",{show:e(o).isOpenEditPassword}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[s("div",fs,[s("div",_s,[s("div",ys,[vs,s("button",{class:"btn-close",type:"button",onClick:a[21]||(a[21]=t=>e(o).isOpenEditPassword=!1)})]),s("div",ks,[s("div",ws,[Es,m(s("input",{type:"password","onUpdate:modelValue":a[22]||(a[22]=t=>e(o).formEditPassword.password=t),placeholder:"Masukkan password ..",class:"form-control mt-2"},null,512),[[p,e(o).formEditPassword.password]])])]),s("div",gs,[s("button",{class:"btn btn-sm btn-secondary",onClick:a[23]||(a[23]=t=>e(o).isOpenEditPassword=!1)}," Tutup "),s("button",{class:"btn btn-sm btn-primary",onClick:a[24]||(a[24]=(...t)=>e(o).editDataPassword&&e(o).editDataPassword(...t))}," Update Password ")])])])],2)):v("",!0),e(o).isOpenPilihUser===!0?(d(),n("div",{key:3,class:y(["modal fade modal-xl",{show:e(o).isOpenPilihUser}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[s("div",Ps,[s("div",Os,[s("div",Us,[Ds,s("button",{class:"btn-close",type:"button",onClick:a[25]||(a[25]=t=>e(o).isOpenPilihUser=!1)})]),s("div",Cs,[s("div",Ss,[xs,m(s("input",{type:"text","onUpdate:modelValue":a[26]||(a[26]=t=>e(o).cariSantri=t),placeholder:"Pilih Nama Santri ..",onKeyup:a[27]||(a[27]=(...t)=>e(o).getSantri&&e(o).getSantri(...t)),class:"form-control mt-2"},null,544),[[p,e(o).cariSantri]])]),As,s("div",Vs,[s("table",$s,[Ts,s("tbody",null,[(d(!0),n(c,null,b(e(o).santriUser,(t,_)=>(d(),n("tr",{key:_,onDblclick:w=>e(o).handleUserPilih(t.uuid,t.nama_lengkap)},[s("td",null,r(t.warga_pesantren.niup),1),s("td",null,r(t.nama_lengkap),1),s("td",null,r(t.domisili_santri.wilayah),1),s("td",null,r(t.domisili_santri.blok),1)],40,Bs))),128))])])])]),s("div",Ls,[s("button",{class:"btn btn-sm btn-secondary",onClick:a[28]||(a[28]=t=>e(o).isOpenPilihUser=!1)}," Batal ")])])])],2)):v("",!0)],64)}}};export{Ms as default};
