import{x as g,C as c,S as U,a as P,g as l,c as d,b as t,d as r,E as _,u as s,F as h,q as b,t as m,v as p,n as y,w as k,z as u,k as O,y as D}from"./index-ed1e1048.js";const f=g("table_user",{state:()=>({roles:[],items:[],params:{cari:"",role:""}}),actions:{async getData(){const n={params:this.params};try{await c.get("user",n).then(i=>{(i.data.code=200)&&(this.items=i.data.data,this.roles=i.data.filter.role)})}catch{}}}}),C=g("form_user",{state:()=>({isOpenAdd:!1,isOpenEdit:!1,isOpenEditPassword:!1,isOpenPilihUser:!1,fotoDiri:"",mode:"internal",editMode:"",isArea:[],personUser:{},idEdit:"",roleValue:"",namaPerson:"",niup:"",formInt:{nama_lengkap:"",niup:"",username:"",role:"",password:"",area_id:""},formEdit:{santri_uuid:"",username:"",role:"",area_id:""},formEditPassword:{password:""}}),actions:{resetForm(){this.formInt.niup="",this.formInt.username="",this.formInt.role="",this.formInt.password="",this.formEdit.santri_uuid="",this.formEdit.username="",this.formEdit.role="",this.formEdit.area_id="",this.formEditPassword.password="",this.mode="internal"},setOpenAdd(){this.isOpenAdd=!this.isOpenAdd},setOpenEdit(){this.isOpenEdit=!this.isOpenEdit,this.resetForm()},setOpenEditPassword(){this.isOpenEditPassword=!this.isOpenEditPassword,this.resetForm()},setInternalMode(){this.mode="internal",this.formInt.role=""},setExternalMode(){this.mode="external",this.formInt.role="p4nj"},setOpenPilihUser(){this.isOpenPilihUser=!this.isOpenPilihUser},async tambahData(){try{const n=await c.post(`user/${this.mode}`,this.formInt);this.isOpenAdd=!1,f().getData(),this.resetForm(),this.namaSantri="",this.santriUser={}}catch{}},async getByNiup(){try{await c.get(`user/pilih/${this.niup}`).then(n=>{(n.data.code=200)&&(this.personUser=n.data.data,this.getImage(this.niup))})}catch{}},async getArea(){try{await c.get("area").then(n=>{this.isArea=n.data.data})}catch{}},async getImage(n){try{const i={responseType:"blob"};await c.get("santri/image/"+n,i).then(e=>{this.fotoDiri=URL.createObjectURL(e.data)})}catch(i){console.log("error",i)}},handleDoubleClik(n){this.idEdit=n.uuid,this.roleValue=n.role?n.role:"kosong",this.formEdit.santri_uuid=n.santri_uuid,this.formEdit.role=n.role,this.formEdit.username=n.username,this.isOpenEdit=!0,this.editMode=n.type,n.role==="p4nj"&&(this.formEdit.area_id=n.area_id)},handleChangePassword(n){this.idEdit=n.uuid,this.formEdit.password=null,this.isOpenEditPassword=!0},handleOpenPilihUser(){this.isOpenPilihUser=!0},handleUserPilih(n,i){this.formInt.niup=i,this.namaPerson=n,this.niup="",this.personUser={},this.isOpenPilihUser=!1},async editData(){try{await c.put(`user/${this.idEdit}`,this.formEdit).then(n=>{this.isOpenEdit=!1,this.resetForm(),f().getData()})}catch{}},async editDataPassword(){try{await c.put(`user/password/${this.idEdit}`,this.formEditPassword).then(n=>{this.isOpenEditPassword=!1,this.resetForm(),f().getData()})}catch{}},async deleteData(){U.fire({title:"Konfirmasi",text:"Apakah anda yakin ingin menghapus data ?",icon:"info",showCancelButton:!0,confirmButtonText:"Hapus",confirmButtonColor:"#DC3545"}).then(n=>{n.isConfirmed&&c.delete(`user/${this.idEdit}`).then(i=>{this.isOpenEdit=!1,this.resetForm(),f().getData()})})}}}),I=t("h3",{class:"titlePage"},"Data User",-1),x=t("hr",null,null,-1),A={class:"filter-box mb-5 row"},V={class:"col-md-2"},M=t("option",{value:"",selected:""},"Semua Hak Akses",-1),S=["value"],T={class:"serach-box row"},N={class:"col-md-10 d-flex align-items-center mb-2"},L={class:"col-md-2 d-flex align-items-center"},B=t("hr",null,null,-1),$={class:"table-responsive"},F={class:"table table-sm table-hover mt-3"},H=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"No"),t("th",{scope:"col"},"Nama"),t("th",{scope:"col"},"Username"),t("th",{scope:"col"},"Hak Akses"),t("th",{scope:"col"})])],-1),j=["onDblclick"],z=["onClick"],K={class:"modal-dialog"},R={class:"modal-content"},q={class:"modal-header"},G=t("h1",{class:"modal-title fs-5",id:"modalTambahLabel"},"Tambah User",-1),J={class:"modal-body"},Q={key:2,class:"form-group mb-3"},W={class:"input-group mb-3"},X={class:"input-group-append"},Y={key:3,class:"form-group mb-3"},Z=t("small",null,"Nama Lengkap",-1),tt={class:"form-group mb-3"},st=t("small",null,"Hak Akses",-1),et=["disabled"],ot=t("option",{value:"",selected:""},"Pilih Hak Akses",-1),at=["value"],nt={key:4,class:"form-group mb-3"},it=t("small",null,"Area",-1),lt=t("option",{value:"",selected:""},"Pilih Area",-1),dt=["value"],rt={class:"form-group mb-3"},mt=t("small",null,"Username",-1),ut={class:"form-group mb-3"},pt=t("small",null,"Password",-1),ct={class:"modal-footer"},ht=t("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),bt={class:"modal-dialog"},_t={class:"modal-content"},ft={class:"modal-header"},yt=t("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit User",-1),kt={class:"modal-body"},vt={class:"form-group mb-3"},gt=t("small",null,"Username",-1),wt={class:"form-group mb-3"},Et=t("small",null,"Hak Akses",-1),Ut=["disabled"],Pt=["value"],Ot={key:0,class:"form-group mb-3"},Dt=t("small",null,"Area",-1),Ct=t("option",{value:"",selected:""},"Pilih Area",-1),It=["value"],xt={class:"modal-footer"},At=t("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),Vt={class:"modal-dialog"},Mt={class:"modal-content"},St={class:"modal-header"},Tt=t("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Update Password",-1),Nt={class:"modal-body"},Lt={class:"form-group mb-3"},Bt=t("small",null,"Password",-1),$t={class:"modal-footer"},Ft=t("button",{type:"submit",class:"btn btn-sm btn-primary"}," Update Password ",-1),Ht={class:"modal-dialog"},jt={class:"modal-content"},zt={class:"modal-header"},Kt=t("h1",{class:"modal-title fs-5",id:"modalEditLabel"}," Cari Santri/Pengurus By NIUP ",-1),Rt={class:"modal-body"},qt={class:"form-group mb-3"},Gt=t("p",null,"Pilih Santri",-1),Jt=t("hr",null,null,-1),Qt={key:0,class:"text-center"},Wt=["src"],Xt=t("p",{class:"fw-bold mb-0"},"NIUP :",-1),Yt={class:"mb-0"},Zt=t("p",{class:"fw-bold mb-0"},"Nama :",-1),ts={class:"mb-0"},ss=t("p",{class:"fw-bold mb-0"},"Tetala :",-1),es={class:"mb-0"},os={class:"modal-footer"},is={__name:"UserPage",setup(n){const i=f(),e=C();return i.getData(),e.getArea(),(as,a)=>{const w=P("font-awesome-icon");return l(),d(h,null,[I,x,t("div",A,[t("div",V,[r(t("select",{class:"form-select form-select-sm","onUpdate:modelValue":a[0]||(a[0]=o=>s(i).params.role=o),onChange:a[1]||(a[1]=(...o)=>s(i).getData&&s(i).getData(...o))},[M,(l(!0),d(h,null,b(s(i).roles,o=>(l(),d("option",{key:o,value:o.key},m(o.value),9,S))),128))],544),[[_,s(i).params.role]])])]),t("div",T,[t("div",N,[t("small",null,"Total data "+m(s(i).items.length),1)]),t("div",L,[r(t("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=o=>s(i).params.cari=o),class:"form-control form-control-sm mb-2",placeholder:"Cari User ...",onKeyup:a[3]||(a[3]=(...o)=>s(i).getData&&s(i).getData(...o))},null,544),[[p,s(i).params.cari]])])]),B,t("button",{class:"btn btn-sm btn-primary",onClick:a[4]||(a[4]=(...o)=>s(e).setOpenAdd&&s(e).setOpenAdd(...o))}," Tambah User "),t("div",$,[t("table",F,[H,t("tbody",null,[(l(!0),d(h,null,b(s(i).items,(o,v)=>(l(),d("tr",{key:v,onDblclick:E=>s(e).handleDoubleClik(o)},[t("td",null,m(v+1),1),t("td",null,m(o.nama_lengkap),1),t("td",null,m("@"+o.username),1),t("td",null,m(o.role),1),t("td",null,[t("button",{onClick:E=>s(e).handleChangePassword(o),class:"btn btn-sm btn-primary"}," Ubah Password ",8,z)])],40,j))),128))])])]),s(e).isOpenAdd===!0?(l(),d("div",{key:0,class:y(["modal fade",{show:s(e).isOpenAdd}]),style:{display:"block"},id:"modalTambah",tabindex:"-1","aria-labelledby":"modalTambahLabel","aria-hidden":"true"},[t("div",K,[t("div",R,[t("div",q,[G,t("button",{class:"btn-close",type:"button",onClick:a[5]||(a[5]=(...o)=>s(e).setOpenAdd&&s(e).setOpenAdd(...o))})]),t("form",{onSubmit:a[17]||(a[17]=k((...o)=>s(e).tambahData&&s(e).tambahData(...o),["prevent"]))},[t("div",J,[s(e).mode==="external"?(l(),d("button",{key:0,class:"btn btn-outline-primary btn-sm me-2 mb-3",onClick:a[6]||(a[6]=(...o)=>s(e).setInternalMode&&s(e).setInternalMode(...o)),type:"button"}," Internal ")):u("",!0),s(e).mode==="internal"?(l(),d("button",{key:1,class:"btn btn-outline-primary btn-sm me-2 mb-3",onClick:a[7]||(a[7]=(...o)=>s(e).setExternalMode&&s(e).setExternalMode(...o)),type:"button"}," External ")):u("",!0),r(t("input",{type:"hidden","onUpdate:modelValue":a[8]||(a[8]=o=>s(e).formInt.niup=o)},null,512),[[p,s(e).formInt.niup]]),s(e).mode==="internal"?(l(),d("div",Q,[t("div",W,[r(t("input",{type:"text","onUpdate:modelValue":a[9]||(a[9]=o=>s(e).namaPerson=o),class:"form-control",placeholder:"Pilih Person ..",disabled:"",readonly:"","aria-describedby":"basic-addon2"},null,512),[[p,s(e).namaPerson]]),t("div",X,[t("button",{class:"btn btn-outline-secondary",onClick:a[10]||(a[10]=(...o)=>s(e).setOpenPilihUser&&s(e).setOpenPilihUser(...o)),type:"button"},[O(w,{icon:"pen-alt"})])])])])):u("",!0),s(e).mode==="external"?(l(),d("div",Y,[Z,r(t("input",{type:"text","onUpdate:modelValue":a[11]||(a[11]=o=>s(e).formInt.nama_lengkap=o),placeholder:"Masukkan nama ..",class:"form-control mt-2"},null,512),[[p,s(e).formInt.nama_lengkap]])])):u("",!0),t("div",tt,[st,r(t("select",{class:"form-select","onUpdate:modelValue":a[12]||(a[12]=o=>s(e).formInt.role=o),disabled:s(e).mode==="external"},[ot,(l(!0),d(h,null,b(s(i).roles,o=>(l(),d("option",{key:o.key,value:o.key},m(o.value),9,at))),128))],8,et),[[_,s(e).formInt.role]])]),s(e).formInt.role==="p4nj"?(l(),d("div",nt,[it,r(t("select",{class:"form-select","onUpdate:modelValue":a[13]||(a[13]=o=>s(e).formInt.area_id=o)},[lt,(l(!0),d(h,null,b(s(e).isArea,o=>(l(),d("option",{key:o,value:o.id},m(o.nama),9,dt))),128))],512),[[_,s(e).formInt.area_id]])])):u("",!0),t("div",rt,[mt,r(t("input",{type:"text","onUpdate:modelValue":a[14]||(a[14]=o=>s(e).formInt.username=o),placeholder:"Masukkan username ..",class:"form-control mt-2"},null,512),[[p,s(e).formInt.username]])]),t("div",ut,[pt,r(t("input",{type:"password","onUpdate:modelValue":a[15]||(a[15]=o=>s(e).formInt.password=o),placeholder:"Masukkan password ..",class:"form-control mt-2"},null,512),[[p,s(e).formInt.password]])])]),t("div",ct,[t("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:a[16]||(a[16]=(...o)=>s(e).setOpenAdd&&s(e).setOpenAdd(...o))}," Tutup "),ht])],32)])])],2)):u("",!0),s(e).isOpenEdit===!0?(l(),d("div",{key:1,class:y(["modal fade",{show:s(e).isOpenEdit}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[t("div",bt,[t("div",_t,[t("div",ft,[yt,t("button",{class:"btn-close",type:"button",onClick:a[18]||(a[18]=(...o)=>s(e).setOpenEdit&&s(e).setOpenEdit(...o))})]),t("form",{onSubmit:a[25]||(a[25]=k((...o)=>s(e).editData&&s(e).editData(...o),["prevent"]))},[t("div",kt,[r(t("input",{type:"hidden","onUpdate:modelValue":a[19]||(a[19]=o=>s(e).formEdit.santri_uuid=o)},null,512),[[p,s(e).formEdit.santri_uuid]]),t("div",vt,[gt,r(t("input",{type:"text","onUpdate:modelValue":a[20]||(a[20]=o=>s(e).formEdit.username=o),placeholder:"Masukkan username ..",class:"form-control mt-2"},null,512),[[p,s(e).formEdit.username]])]),t("div",wt,[Et,r(t("select",{class:"form-select","onUpdate:modelValue":a[21]||(a[21]=o=>s(e).formEdit.role=o),disabled:s(e).editMode==="external"},[(l(!0),d(h,null,b(s(i).roles,o=>(l(),d("option",{key:o.key,value:o.key},m(o.value),9,Pt))),128))],8,Ut),[[_,s(e).formEdit.role]])]),s(e).formEdit.role==="p4nj"?(l(),d("div",Ot,[Dt,r(t("select",{class:"form-select","onUpdate:modelValue":a[22]||(a[22]=o=>s(e).formEdit.area_id=o)},[Ct,(l(!0),d(h,null,b(s(e).isArea,o=>(l(),d("option",{key:o,value:o.id},m(o.nama),9,It))),128))],512),[[_,s(e).formEdit.area_id]])])):u("",!0)]),t("div",xt,[t("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:a[23]||(a[23]=o=>s(e).isOpenEdit=!1)}," Tutup "),t("button",{type:"button",class:"btn btn-sm btn-danger",onClick:a[24]||(a[24]=(...o)=>s(e).deleteData&&s(e).deleteData(...o))}," Hapus "),At])],32)])])],2)):u("",!0),s(e).isOpenEditPassword===!0?(l(),d("div",{key:2,class:y(["modal fade",{show:s(e).isOpenEditPassword}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[t("div",Vt,[t("div",Mt,[t("div",St,[Tt,t("button",{class:"btn-close",type:"button",onClick:a[26]||(a[26]=(...o)=>s(e).setOpenEditPassword&&s(e).setOpenEditPassword(...o))})]),t("form",{onSubmit:a[29]||(a[29]=k((...o)=>s(e).editDataPassword&&s(e).editDataPassword(...o),["prevent"]))},[t("div",Nt,[t("div",Lt,[Bt,r(t("input",{type:"password","onUpdate:modelValue":a[27]||(a[27]=o=>s(e).formEditPassword.password=o),placeholder:"Masukkan password ..",class:"form-control mt-2"},null,512),[[p,s(e).formEditPassword.password]])])]),t("div",$t,[t("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:a[28]||(a[28]=(...o)=>s(e).setOpenEditPassword&&s(e).setOpenEditPassword(...o))}," Tutup "),Ft])],32)])])],2)):u("",!0),s(e).isOpenPilihUser===!0?(l(),d("div",{key:3,class:y(["modal fade modal-lg",{show:s(e).isOpenPilihUser}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[t("div",Ht,[t("div",jt,[t("div",zt,[Kt,t("button",{class:"btn-close",type:"button",onClick:a[30]||(a[30]=o=>s(e).isOpenPilihUser=!1)})]),t("div",Rt,[t("div",qt,[Gt,r(t("input",{type:"text","onUpdate:modelValue":a[31]||(a[31]=o=>s(e).niup=o),placeholder:"Masukkan NIUP",class:"form-control mt-2"},null,512),[[p,s(e).niup]])]),t("button",{class:"btn btn-sm btn-warning",onClick:a[32]||(a[32]=(...o)=>s(e).getByNiup&&s(e).getByNiup(...o))}," Preview "),Jt,s(e).personUser.warga_pesantren?(l(),d("div",Qt,[r(t("img",{src:s(e).fotoDiri,alt:"pohto-profile",width:"200",class:"img-thumbnail"},null,8,Wt),[[D,s(e).fotoDiri!=""]]),Xt,t("p",Yt,m(s(e).personUser?s(e).personUser.warga_pesantren.niup:"-"),1),Zt,t("p",ts,m(s(e).personUser?s(e).personUser.nama_lengkap:"-"),1),ss,t("p",es,m(s(e).personUser?s(e).personUser.tempat_lahir+", "+s(e).personUser.tanggal_lahir:"-"),1)])):u("",!0)]),t("div",os,[t("button",{class:"btn btn-sm btn-success",onClick:a[33]||(a[33]=o=>s(e).handleUserPilih(s(e).personUser.nama_lengkap,s(e).personUser.warga_pesantren.niup))}," Pilih "),t("button",{class:"btn btn-sm btn-secondary",onClick:a[34]||(a[34]=o=>s(e).isOpenPilihUser=!1)}," Batal ")])])])],2)):u("",!0)],64)}}};export{is as default};
