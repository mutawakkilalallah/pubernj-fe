import{m as d,q as r,s as o,x as s,y as n,z as i,A as c,B as h,C as m,D as g,E as f,G as k}from"./index-06dc9e56.js";const p=d("auth",{state:()=>({token:localStorage.getItem("token")?r():null,user:localStorage.getItem("user")?o():null,nama:localStorage.getItem("nama")?s():null,foto:localStorage.getItem("foto")?n():null,loading:!1,alert:!1}),getters:{isAuth(e){return e.token!==null||e.token!==void 0},getToken:()=>r(),useGetter:()=>o()!==null||o()!==void 0,getNamaLengkap:()=>s()!==null||s()!==void 0,getFotoProfil:()=>n()!==null||n()!==void 0},actions:{async login(e){this.loading=!0;try{await i.post("login",e).then(t=>{c(t.data.token),h(t.data.data),m(t.data.santri.nama_lengkap);const a=r(),l=o(),u=s();a?(this.alert=!0,this.getImage(t.data.santri.uuid),this.SET_TOKEN_USER(a,l,u),this.loading=!1):(this.loading=!1,g.push("/login"))})}catch(t){console.log("error",t),this.loading=!1}},async getImage(e){this.loading=!0;try{const t={responseType:"blob"};await i.get("santri/image/"+e,t).then(a=>{f(URL.createObjectURL(a.data));const l=n();this.foto=l})}catch(t){console.log("error",t),this.loading=!1}},SET_TOKEN_USER(e,t,a){k(e),this.token=e,this.user=t,this.nama=a,g.push("/")}}});export{p as u};
