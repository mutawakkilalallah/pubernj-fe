import{x,D as A,C as _,S as O,o as w,g as i,c as r,b as t,u as o,d as m,E as c,F as b,s as f,t as p,v as u,z as h,n as k,w as D,G as E}from"./index-47bc540a.js";import{u as g,F as C,w as T}from"./FileSaver.min-848fb5bc.js";const y=x("table_dropspot",{state:()=>({user:localStorage.getItem("user")?A():null,items:[],params:{cari:"",area:""}}),actions:{async getData(){const l={params:this.params};try{await _.get("dropspot",l).then(n=>{(n.data.code=200)&&(this.items=n.data.data)})}catch{}},exportExel(){const l=this.tanggal(),n=this.formatJson(this.items),a=g.json_to_sheet(n),d=g.book_new();g.book_append_sheet(d,a,"Data");const s=this.writeExcelBuffer(d);this.saveExcelFile(s,`Data Armada ${l}.xlsx`)},saveExcelFile(l,n){const a=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});C.saveAs(a,n)},writeExcelBuffer(l){return T(l,{bookType:"xlsx",type:"array"})},formatJson(l){const n=[];return l.forEach(a=>{const d={area:"",cakupan:"",dropspot:"",jam_berangkat:"",tarif:""};d.area=a.area.nama,d.cakupan=a.cakupan,d.dropspot=a.nama,d.jam_berangkat=a.jam_berangkat,d.tarif=a.harga,n.push(d)}),n},tanggal(){const l=new Date,n=l.getDate(),a=l.getMonth()+1,d=l.getFullYear();return(n<=9?"0"+n:n)+"-"+(a<=9?"0"+a:a)+"-"+d}}}),V=x("form_dropspot",{state:()=>({isOpenAdd:!1,isOpenEdit:!1,isArea:[],idEdit:"",namaArea:"",form:{nama:"",type:"",area_id:"",cakupan:"",harga:""}}),actions:{resetForm(){this.form.nama="",this.form.type="",this.form.area_id="",this.form.cakupan="",this.form.harga=""},setOpenAdd(){this.isOpenAdd=!this.isOpenAdd},setOpenEdit(){this.isOpenEdit=!this.isOpenEdit,this.resetForm()},getArea(){try{_.get("area").then(l=>{this.isArea=l.data.data})}catch{}},async tambahData(){try{const l=await _.post("dropspot",this.form);this.isOpenAdd=!1,y().getData(),this.resetForm()}catch{}},handleDoubleClik(l){this.idEdit=l.id,this.namaArea=l.area?l.area.nama:"kosong",this.form.nama=l.nama,this.form.type=l.type,this.form.area_id=l.area_id,this.form.cakupan=l.cakupan,this.form.harga=l.harga,this.isOpenEdit=!0},async editData(){try{await _.put(`dropspot/${this.idEdit}`,this.form).then(l=>{this.isOpenEdit=!1,this.resetForm(),y().getData()})}catch{}},async deleteData(){O.fire({title:"Konfirmasi",text:"Apakah anda yakin ingin menghapus data ?",icon:"info",showCancelButton:!0,confirmButtonText:"Hapus",confirmButtonColor:"#DC3545"}).then(l=>{l.isConfirmed&&_.delete(`dropspot/${this.idEdit}`).then(n=>{this.isOpenEdit=!1,this.resetForm(),y().getData()})})}}}),S={class:"row"},F=t("div",{class:"col-md-8"},[t("h3",{class:"titlePage"},"Data Dropspot")],-1),U={class:"col-md-4 text-end"},B=t("hr",null,null,-1),M={class:"filter-box mb-5 row"},N={class:"col-md-2"},H=t("option",{value:"",selected:""},"Semua Area",-1),L=["value"],j={class:"serach-box row"},P={class:"col-md-10 d-flex align-items-center mb-2"},$={class:"col-md-2 d-flex align-items-center"},z=t("hr",null,null,-1),J={class:"table-responsive"},K={class:"table table-sm table-hover mt-3"},G=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"No"),t("th",{scope:"col"},"Nama Dropspot"),t("th",{scope:"col"},"Area"),t("th",{scope:"col"},"Harga"),t("th",{scope:"col"},"Cakupan")])],-1),I=["onDblclick"],R={class:"modal-dialog"},Y={class:"modal-content"},q={class:"modal-header"},Q=t("h1",{class:"modal-title fs-5",id:"modalTambahLabel"},"Tambah Dropsot",-1),W={class:"modal-body"},X={class:"form-group mb-3"},Z=t("small",null,"Nama Dropspot",-1),tt={class:"form-group mb-3"},et=t("small",null,"Type",-1),at=E('<option value="" selected>Pilih Type</option><option value="by_negara" selected>by_negara</option><option value="by_provinsi" selected>by_provinsi</option><option value="by_kabupaten" selected>by_kabupaten</option><option value="by_kecamatan" selected>by_kecamatan</option><option value="by_desa" selected>by_desa</option>',6),ot=[at],st={class:"form-group mb-3"},nt=t("small",null,"Area",-1),lt=t("option",{value:"",selected:""},"Pilih Area",-1),it=["value"],rt={class:"form-group mb-3"},dt=t("small",null,"Cakupan Daerah",-1),mt={class:"form-group mb-3"},pt=t("small",null,"Harga",-1),ut={class:"modal-footer"},ct=t("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),bt={class:"modal-dialog"},ht={class:"modal-content"},_t={class:"modal-header"},ft=t("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit Dropspot",-1),yt={class:"modal-body"},gt={class:"form-group mb-3"},vt=t("small",null,"Nama Dropspot",-1),kt={class:"form-group mb-3"},Dt=t("small",null,"Type",-1),xt=E('<option value="by_negara" selected>by_negara</option><option value="by_provinsi" selected>by_provinsi</option><option value="by_kabupaten" selected>by_kabupaten</option><option value="by_kecamatan" selected>by_kecamatan</option><option value="by_desa" selected>by_desa</option>',5),Et=[xt],At={class:"form-group mb-3"},Ot=t("small",null,"Area",-1),wt={value:"",selected:""},Ct=["value"],Tt={class:"form-group mb-3"},Vt=t("small",null,"Cakupan Daerah",-1),St={class:"form-group mb-3"},Ft=t("small",null,"Harga",-1),Ut={class:"modal-footer"},Bt={key:1,type:"submit",class:"btn btn-sm btn-primary"},Lt={__name:"DropspotPage",setup(l){const n=y(),a=V();return n.getData(),a.getArea(),w(()=>{a.getArea()}),(d,s)=>(i(),r(b,null,[t("div",S,[F,t("div",U,[t("button",{class:"btn btn-outline-primary",type:"button",onClick:s[0]||(s[0]=(...e)=>o(n).exportExel&&o(n).exportExel(...e))},"Export")])]),B,t("div",M,[t("div",N,[m(t("select",{class:"form-select form-select-sm","onUpdate:modelValue":s[1]||(s[1]=e=>o(n).params.area=e),onChange:s[2]||(s[2]=(...e)=>o(n).getData&&o(n).getData(...e))},[H,(i(!0),r(b,null,f(o(a).isArea,e=>(i(),r("option",{key:e,value:e.id},p(e.nama),9,L))),128))],544),[[c,o(n).params.area]])])]),t("div",j,[t("div",P,[t("small",null,"Total data "+p(o(n).items.length),1)]),t("div",$,[m(t("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=e=>o(n).params.cari=e),class:"form-control form-control-sm mb-2",placeholder:"Cari Dropspot ...",onKeyup:s[4]||(s[4]=(...e)=>o(n).getData&&o(n).getData(...e))},null,544),[[u,o(n).params.cari]])])]),z,o(n).user.role=="sysadmin"?(i(),r("button",{key:0,class:"btn btn-sm btn-primary",onClick:s[5]||(s[5]=(...e)=>o(a).setOpenAdd&&o(a).setOpenAdd(...e))}," Tambah Dropspot ")):h("",!0),t("div",J,[t("table",K,[G,t("tbody",null,[(i(!0),r(b,null,f(o(n).items,(e,v)=>(i(),r("tr",{key:v,onDblclick:Mt=>o(n).user.role==="sysadmin"&&o(a).handleDoubleClik(e)},[t("td",null,p(v+1),1),t("td",null,p(e.nama),1),t("td",null,p(e.area.nama),1),t("td",null,p("Rp. "+e.harga),1),t("td",null,p(e.cakupan),1)],40,I))),128))])])]),o(a).isOpenAdd===!0?(i(),r("div",{key:1,class:k(["modal fade",{show:o(a).isOpenAdd}]),style:{display:"block"},id:"modalTambah",tabindex:"-1","aria-labelledby":"modalTambahLabel","aria-hidden":"true"},[t("div",R,[t("div",Y,[t("div",q,[Q,t("button",{class:"btn-close",type:"button",onClick:s[6]||(s[6]=(...e)=>o(a).setOpenAdd&&o(a).setOpenAdd(...e))})]),t("form",{onSubmit:s[13]||(s[13]=D((...e)=>o(a).tambahData&&o(a).tambahData(...e),["prevent"]))},[t("div",W,[t("div",X,[Z,m(t("input",{type:"text","onUpdate:modelValue":s[7]||(s[7]=e=>o(a).form.nama=e),placeholder:"Masukkan nama dropspot ..",class:"form-control mt-2"},null,512),[[u,o(a).form.nama]])]),t("div",tt,[et,m(t("select",{class:"form-select","onUpdate:modelValue":s[8]||(s[8]=e=>o(a).form.type=e)},ot,512),[[c,o(a).form.type]])]),t("div",st,[nt,m(t("select",{class:"form-select","onUpdate:modelValue":s[9]||(s[9]=e=>o(a).form.area_id=e)},[lt,(i(!0),r(b,null,f(o(a).isArea,e=>(i(),r("option",{key:e,value:e.id},p(e.nama),9,it))),128))],512),[[c,o(a).form.area_id]])]),t("div",rt,[dt,m(t("input",{type:"text","onUpdate:modelValue":s[10]||(s[10]=e=>o(a).form.cakupan=e),placeholder:"Masukkan cakupan daerah ..",class:"form-control mt-2"},null,512),[[u,o(a).form.cakupan]])]),t("div",mt,[pt,m(t("input",{type:"text","onUpdate:modelValue":s[11]||(s[11]=e=>o(a).form.harga=e),placeholder:"Masukkan cakupan harga ..",class:"form-control mt-2"},null,512),[[u,o(a).form.harga]])])]),t("div",ut,[t("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:s[12]||(s[12]=(...e)=>o(a).setOpenAdd&&o(a).setOpenAdd(...e))}," Tutup "),ct])],32)])])],2)):h("",!0),o(a).isOpenEdit===!0?(i(),r("div",{key:2,class:k(["modal fade",{show:o(a).isOpenEdit}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[t("div",bt,[t("div",ht,[t("div",_t,[ft,t("button",{class:"btn-close",type:"button",onClick:s[14]||(s[14]=(...e)=>o(a).setOpenEdit&&o(a).setOpenEdit(...e))})]),t("form",{onSubmit:s[22]||(s[22]=D((...e)=>o(a).editData&&o(a).editData(...e),["prevent"]))},[t("div",yt,[t("div",gt,[vt,m(t("input",{type:"text",class:"form-control mt-2","onUpdate:modelValue":s[15]||(s[15]=e=>o(a).form.nama=e)},null,512),[[u,o(a).form.nama]])]),t("div",kt,[Dt,m(t("select",{class:"form-select","onUpdate:modelValue":s[16]||(s[16]=e=>o(a).form.type=e)},Et,512),[[c,o(a).form.type]])]),t("div",At,[Ot,m(t("select",{class:"form-select","onUpdate:modelValue":s[17]||(s[17]=e=>o(a).form.area_id=e)},[t("option",wt,p(o(a).namaArea),1),(i(!0),r(b,null,f(o(a).isArea,e=>(i(),r("option",{key:e,value:e.id},p(e.nama),9,Ct))),128))],512),[[c,o(a).form.area_id]])]),t("div",Tt,[Vt,m(t("input",{type:"text",class:"form-control mt-2","onUpdate:modelValue":s[18]||(s[18]=e=>o(a).form.cakupan=e)},null,512),[[u,o(a).form.cakupan]])]),t("div",St,[Ft,m(t("input",{type:"text",class:"form-control mt-2","onUpdate:modelValue":s[19]||(s[19]=e=>o(a).form.harga=e)},null,512),[[u,o(a).form.harga]])])]),t("div",Ut,[t("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:s[20]||(s[20]=(...e)=>o(a).setOpenEdit&&o(a).setOpenEdit(...e))}," Tutup "),o(n).user.role=="sysadmin"?(i(),r("button",{key:0,type:"button",class:"btn btn-sm btn-danger",onClick:s[21]||(s[21]=(...e)=>o(a).deleteData&&o(a).deleteData(...e))}," Hapus ")):h("",!0),o(n).user.role=="sysadmin"?(i(),r("button",Bt," Simpan ")):h("",!0)])],32)])])],2)):h("",!0)],64))}};export{Lt as default};
