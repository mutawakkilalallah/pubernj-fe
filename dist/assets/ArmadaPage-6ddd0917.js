import{x,D as T,C as h,S as N,o as j,a as E,g as l,c as d,b as t,u as e,z as m,d as r,E as u,F as _,s as b,t as p,v as g,l as P,m as F,q as v,n as k,w as U,i as M,G as D}from"./index-47bc540a.js";import{u as $}from"./index-662c665e.js";const f=x("table_armada",{state:()=>({user:localStorage.getItem("user")?T():null,items:[],itemsPendamping:[],filter:{area:[],dropspot:[]},meta:{},paramsPendamping:{cari:"",role:"pendamping"},params:{cari:"",area:"",dropspot:"",type:"",jenis:""}}),actions:{async getData(){const i={params:this.params};try{await h.get("armada",i).then(n=>{(n.data.code=200)&&(this.items=n.data.data,this.filter.area=n.data.filter.area,this.meta=n.headers)})}catch{}},async getPendamping(){const i={params:this.paramsPendamping};try{await h.get("user",i).then(n=>{(n.data.code=200)&&(this.itemsPendamping=n.data.data)})}catch{}},async getDropspot(){this.params.dropspot="",this.getData();const i={params:{area:this.params.area}};try{await h.get("dropspot",i).then(n=>{(n.data.code=200)&&(this.filter.dropspot=n.data.data)})}catch{}}}}),B=x("form_armada",{state:()=>({isOpenAdd:!1,isOpenEdit:!1,isOpenPendamping:!1,isArea:[],isDropspot:[],idEdit:"",idArea:"",namaArea:"",namaDropsot:"",data_pendamping:{},formPendamping:{user_uuid:""},form:{nama:"",type:"",jenis:"",harga:"",dropspot_id:""}}),actions:{resetForm(){this.idArea="",this.form.nama="",this.form.type="",this.form.jenis="",this.form.harga="",this.form.dropspot_id=""},setOpenAdd(){this.isOpenAdd=!this.isOpenAdd},setOpenEdit(){this.isOpenEdit=!this.isOpenEdit,this.resetForm()},setOpenPendamping(i){this.idEdit=i.id,this.data_pendamping=i.user?i.user:{},this.isOpenPendamping=!this.isOpenPendamping,this.formPendamping.user_uuid=""},async setPendamping(i){this.formPendamping.user_uuid=i;try{await h.put(`armada/pendamping/${this.idEdit}`,this.formPendamping).then(n=>{this.isOpenPendamping=!1,this.resetForm(),this.formPendamping.user_uuid="";const o=f();o.paramsPendamping.cari="",o.itemsPendamping=[],o.getData()})}catch{}},async deletePendamping(){try{await h.put(`armada/pendamping/delete/${this.idEdit}`).then(i=>{this.isOpenPendamping=!1,this.resetForm(),this.formPendamping.user_uuid="";const n=f();n.paramsPendamping.cari="",n.itemsPendamping=[],n.getData()})}catch{}},getArea(){try{h.get("area").then(i=>{this.isArea=i.data.data})}catch{}},async getDropspot(){this.form.dropspot_id="";const i={params:{area:this.idArea}};try{await h.get("dropspot",i).then(n=>{this.isDropspot=n.data.data})}catch{}},async tambahData(){try{await h.post("armada",this.form),this.isOpenAdd=!1,f().getData(),this.resetForm()}catch{}},handleDoubleClik(i){this.idEdit=i.id,this.idArea=i.dropspot.area_id,this.namaDropsot=i.dropspot.nama,this.form.nama=i.nama,this.form.type=i.type,this.form.jenis=i.jenis,this.form.harga=i.harga,this.getDropspot(),this.form.dropspot_id=i.dropspot_id,this.isOpenEdit=!0},async editData(){try{await h.put(`armada/${this.idEdit}`,this.form).then(i=>{this.isOpenEdit=!1,this.resetForm(),f().getData()})}catch{}},async deleteData(){N.fire({title:"Konfirmasi",text:"Apakah anda yakin ingin menghapus data ?",icon:"info",showCancelButton:!0,confirmButtonText:"Hapus",confirmButtonColor:"#DC3545"}).then(i=>{i.isConfirmed&&h.delete(`armada/${this.idEdit}`).then(n=>{this.isOpenEdit=!1,this.resetForm(),f().getData()})})}}}),H={class:"row"},L=t("div",{class:"col-md-8"},[t("h3",{class:"titlePage"},"Data Armada")],-1),I={key:0,class:"col-md-4 text-end"},J=t("hr",null,null,-1),K={class:"filter-box mb-5 row"},R={key:0,class:"col-md-2"},z=t("option",{value:"",selected:""},"Semua Area",-1),G=["value"],q=["disabled"],Q=t("option",{value:"",selected:""},"Semua Dropsot",-1),W=["value"],X={class:"col-md-2"},Y=D('<option value="" selected>Semua Type</option><option value="bus" selected>BUS</option><option value="minibus" selected>MINIBUS</option><option value="elf" selected>ELF</option><option value="hiace" selected>HIACE</option><option value="mpv" selected>MPV</option>',6),Z=[Y],tt=t("option",{value:"",selected:""},"Semua Jenis",-1),et=t("option",{value:"putra",selected:""},"PUTRA",-1),st=t("option",{value:"putri",selected:""},"PUTRI",-1),ot=[tt,et,st],at={class:"serach-box row"},nt={class:"col-md-10 d-flex align-items-center mb-2"},it={class:"col-md-2 d-flex align-items-center"},lt=t("hr",null,null,-1),dt={class:"table-responsive"},rt={class:"table table-sm table-hover mt-3"},pt=t("th",{scope:"col"},"No",-1),mt=t("th",{scope:"col"},"Nama Armada",-1),ut=t("th",{scope:"col"},"Type",-1),ct=t("th",{scope:"col"},"Jenis",-1),ht={key:0,scope:"col"},_t={key:1,scope:"col"},bt=t("th",{scope:"col"},"Dropspot",-1),gt=t("th",{scope:"col"},"Harga",-1),ft=["onDblclick"],yt={key:0},vt={class:"btn btn-primary btn-sm"},Pt={key:1},kt=["onClick"],Dt={class:"modal-dialog"},At={class:"modal-content"},Ot={class:"modal-header"},Ct=t("h1",{class:"modal-title fs-5",id:"modalTambahLabel"},"Tambah Armada",-1),Et={class:"modal-body"},Ut={class:"form-group mb-3"},xt=t("small",null,"Urutan Armada",-1),Vt=t("small",{class:"text-danger"},"*) saat membuat armada penamaan masukkan urutan saja contoh 1,2,3 dari setiap dropspot",-1),wt={class:"form-group mb-3"},St=t("small",null,"Type",-1),Tt=D('<option value="" selected>Pilih Type</option><option value="bus" selected>bus</option><option value="minibus" selected>minibus</option><option value="elf" selected>elf</option><option value="hiace" selected>hiace</option><option value="mpv" selected>mpv</option>',6),Nt=[Tt],jt={class:"form-group mb-3"},Ft=t("small",null,"Jenis",-1),Mt=t("option",{value:"",selected:""},"Pilih Jenis",-1),$t=t("option",{value:"putra",selected:""},"putra",-1),Bt=t("option",{value:"putri",selected:""},"putri",-1),Ht=[Mt,$t,Bt],Lt={class:"form-group mb-3"},It=t("small",null,"Area",-1),Jt=t("option",{value:"",selected:""},"Pilih Area",-1),Kt=["value"],Rt={class:"form-group mb-3"},zt=t("small",null,"Dropspot",-1),Gt=["disabled"],qt=t("option",{value:"",selected:""},"Pilih Dropsot",-1),Qt=["value"],Wt={class:"form-group mb-3"},Xt=t("small",null,"Harga Armada",-1),Yt={class:"modal-footer"},Zt=t("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),te={class:"modal-dialog"},ee={class:"modal-content"},se={class:"modal-header"},oe=t("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit Armada",-1),ae={class:"modal-body"},ne={class:"form-group mb-3"},ie=t("small",null,"Nama Armada",-1),le={class:"form-group mb-3"},de=t("small",null,"Type",-1),re=D('<option value="bus" selected>bus</option><option value="minibus" selected>minibus</option><option value="elf" selected>elf</option><option value="hiace" selected>hiace</option><option value="mpv" selected>mpv</option>',5),pe=[re],me={class:"form-group mb-3"},ue=t("small",null,"Jenis",-1),ce=t("option",{value:"putra",selected:""},"putra",-1),he=t("option",{value:"putri",selected:""},"putri",-1),_e=[ce,he],be={class:"form-group mb-3"},ge=t("small",null,"Area",-1),fe=t("option",{value:"",selected:""},"Pilih Area",-1),ye=["value"],ve={class:"form-group mb-3"},Pe=t("small",null,"Dropspot",-1),ke=["disabled"],De={key:0,value:"",selected:""},Ae=["value"],Oe={class:"form-group mb-3"},Ce=t("small",null,"Harga Armada",-1),Ee={class:"modal-footer"},Ue={key:1,type:"submit",class:"btn btn-sm btn-primary"},xe={class:"modal-dialog"},Ve={class:"modal-content"},we={class:"modal-header"},Se=t("h1",{class:"modal-title fs-5",id:"modalEditLabel"}," Kelola Pendamping ",-1),Te={class:"modal-body"},Ne=t("b",null,"Nama Pendamping : ",-1),je=t("b",null,"NO. HP : ",-1),Fe={class:"modal-body"},Me={class:"table-responsive"},$e={class:"table table-sm table-hover mt-3"},Be=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"No"),t("th",{scope:"col"},"Nama"),t("th",{scope:"col"})])],-1),He=["onClick"],Le={class:"modal-footer"},Ke={__name:"ArmadaPage",setup(i){const n=f(),o=B(),c=$();function V(){M.replace("/armada-print")}const w=A=>"Rp. "+A.toString().replace(/(\d)(?=(\d{3})+(?:\.\d+)?$)/g,"$1.");return j(()=>{n.getData(),o.getArea()}),(A,a)=>{const O=E("font-awesome-icon"),S=E("router-link");return l(),d(_,null,[t("div",H,[L,e(c).user.role!="pendamping"&&e(c).user.role!="p4nj"?(l(),d("div",I,[t("button",{class:"btn btn-outline-primary",type:"button",onClick:V}," Page Print ")])):m("",!0)]),J,t("div",K,[e(c).user.role!="pendamping"?(l(),d("div",R,[r(t("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":a[0]||(a[0]=s=>e(n).params.area=s),onChange:a[1]||(a[1]=(...s)=>e(n).getDropspot&&e(n).getDropspot(...s))},[z,(l(!0),d(_,null,b(e(n).filter.area,s=>(l(),d("option",{key:s,value:s.id},p(s.nama),9,G))),128))],544),[[u,e(n).params.area]]),r(t("select",{class:"form-select form-select-sm mb-2",disabled:e(n).params.area==="","onUpdate:modelValue":a[2]||(a[2]=s=>e(n).params.dropspot=s),onChange:a[3]||(a[3]=(...s)=>e(n).getData&&e(n).getData(...s))},[Q,(l(!0),d(_,null,b(e(n).filter.dropspot,s=>(l(),d("option",{key:s,value:s.id},p(s.nama),9,W))),128))],40,q),[[u,e(n).params.dropspot]])])):m("",!0),t("div",X,[r(t("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":a[4]||(a[4]=s=>e(n).params.type=s),onChange:a[5]||(a[5]=(...s)=>e(n).getData&&e(n).getData(...s))},Z,544),[[u,e(n).params.type]]),r(t("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":a[6]||(a[6]=s=>e(n).params.jenis=s),onChange:a[7]||(a[7]=(...s)=>e(n).getData&&e(n).getData(...s))},ot,544),[[u,e(n).params.jenis]])])]),t("div",at,[t("div",nt,[t("small",null,"Total data "+p(e(n).meta.x_total_data),1)]),t("div",it,[r(t("input",{type:"text","onUpdate:modelValue":a[8]||(a[8]=s=>e(n).params.cari=s),class:"form-control form-control-sm mb-2",placeholder:"Cari Armada ...",onKeyup:a[9]||(a[9]=(...s)=>e(n).getData&&e(n).getData(...s))},null,544),[[g,e(n).params.cari]])])]),lt,e(n).user.role=="sysadmin"||e(n).user.role=="armada"?(l(),d("button",{key:0,class:"btn btn-sm btn-primary",onClick:a[10]||(a[10]=(...s)=>e(o).setOpenAdd&&e(o).setOpenAdd(...s))}," Tambah Armada ")):m("",!0),t("div",dt,[t("table",rt,[t("thead",null,[t("tr",null,[pt,mt,ut,ct,e(c).user.role==="sysadmin"||e(c).user.role==="admin"?(l(),d("th",ht," Penumpang ")):m("",!0),e(c).user.role==="sysadmin"||e(c).user.role==="admin"?(l(),d("th",_t," Pendamping ")):m("",!0),bt,gt])]),t("tbody",null,[(l(!0),d(_,null,b(e(n).items,(s,y)=>(l(),d("tr",{key:y,onDblclick:C=>e(n).user.role==="sysadmin"||e(n).user.role==="admin"||e(n).user.role==="armada"&&e(o).handleDoubleClik(s)},[t("td",null,p(y+1),1),t("td",null,p(s.nama),1),t("td",null,p(s.type.toUpperCase()),1),t("td",null,p(s.jenis.toUpperCase()),1),e(c).user.role==="sysadmin"||e(c).user.role==="admin"?(l(),d("td",yt,[P(S,{to:{name:"armada-detail",params:{id:s.id}}},{default:F(()=>[t("button",vt,[P(O,{icon:"clipboard",class:"icon"}),v(" Daftar Penumpang ")])]),_:2},1032,["to"])])):m("",!0),e(c).user.role==="sysadmin"||e(c).user.role==="admin"?(l(),d("td",Pt,[t("button",{class:"btn btn-primary btn-sm",onClick:C=>e(o).setOpenPendamping(s)},[P(O,{icon:"user-md",class:"icon"}),v(" Pendamping ")],8,kt)])):m("",!0),t("td",null,p(s.dropspot.nama),1),t("td",null,p(w(s.dropspot.harga)),1)],40,ft))),128))])])]),e(o).isOpenAdd===!0?(l(),d("div",{key:1,class:k(["modal fade",{show:e(o).isOpenAdd}]),style:{display:"block"},id:"modalTambah",tabindex:"-1","aria-labelledby":"modalTambahLabel","aria-hidden":"true"},[t("div",Dt,[t("div",At,[t("div",Ot,[Ct,t("button",{class:"btn-close",type:"button",onClick:a[11]||(a[11]=(...s)=>e(o).setOpenAdd&&e(o).setOpenAdd(...s))})]),t("form",{onSubmit:a[20]||(a[20]=U((...s)=>e(o).tambahData&&e(o).tambahData(...s),["prevent"]))},[t("div",Et,[t("div",Ut,[xt,r(t("input",{type:"text","onUpdate:modelValue":a[12]||(a[12]=s=>e(o).form.nama=s),placeholder:"Masukkan urutan armada ..",class:"form-control mt-2"},null,512),[[g,e(o).form.nama]]),Vt]),t("div",wt,[St,r(t("select",{class:"form-select","onUpdate:modelValue":a[13]||(a[13]=s=>e(o).form.type=s)},Nt,512),[[u,e(o).form.type]])]),t("div",jt,[Ft,r(t("select",{class:"form-select","onUpdate:modelValue":a[14]||(a[14]=s=>e(o).form.jenis=s)},Ht,512),[[u,e(o).form.jenis]])]),t("div",Lt,[It,r(t("select",{class:"form-select","onUpdate:modelValue":a[15]||(a[15]=s=>e(o).idArea=s),onChange:a[16]||(a[16]=(...s)=>e(o).getDropspot&&e(o).getDropspot(...s))},[Jt,(l(!0),d(_,null,b(e(o).isArea,s=>(l(),d("option",{key:s,value:s.id},p(s.nama),9,Kt))),128))],544),[[u,e(o).idArea]])]),t("div",Rt,[zt,r(t("select",{class:"form-select","onUpdate:modelValue":a[17]||(a[17]=s=>e(o).form.dropspot_id=s),disabled:e(o).idArea===""},[qt,(l(!0),d(_,null,b(e(o).isDropspot,s=>(l(),d("option",{key:s,value:s.id},p(s.nama),9,Qt))),128))],8,Gt),[[u,e(o).form.dropspot_id]])]),t("div",Wt,[Xt,r(t("input",{type:"text","onUpdate:modelValue":a[18]||(a[18]=s=>e(o).form.harga=s),placeholder:"Masukkan harga armada ..",class:"form-control mt-2"},null,512),[[g,e(o).form.harga]])])]),t("div",Yt,[t("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:a[19]||(a[19]=(...s)=>e(o).setOpenAdd&&e(o).setOpenAdd(...s))}," Tutup "),Zt])],32)])])],2)):m("",!0),e(o).isOpenEdit===!0?(l(),d("div",{key:2,class:k(["modal fade",{show:e(o).isOpenEdit}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[t("div",te,[t("div",ee,[t("div",se,[oe,t("button",{class:"btn-close",type:"button",onClick:a[21]||(a[21]=(...s)=>e(o).setOpenEdit&&e(o).setOpenEdit(...s))})]),t("form",{onSubmit:a[31]||(a[31]=U((...s)=>e(o).editData&&e(o).editData(...s),["prevent"]))},[t("div",ae,[t("div",ne,[ie,r(t("input",{type:"text",class:"form-control mt-2","onUpdate:modelValue":a[22]||(a[22]=s=>e(o).form.nama=s)},null,512),[[g,e(o).form.nama]])]),t("div",le,[de,r(t("select",{class:"form-select","onUpdate:modelValue":a[23]||(a[23]=s=>e(o).form.type=s)},pe,512),[[u,e(o).form.type]])]),t("div",me,[ue,r(t("select",{class:"form-select","onUpdate:modelValue":a[24]||(a[24]=s=>e(o).form.jenis=s)},_e,512),[[u,e(o).form.jenis]])]),t("div",be,[ge,r(t("select",{class:"form-select","onUpdate:modelValue":a[25]||(a[25]=s=>e(o).idArea=s),onChange:a[26]||(a[26]=(...s)=>e(o).getDropspot&&e(o).getDropspot(...s))},[fe,(l(!0),d(_,null,b(e(o).isArea,s=>(l(),d("option",{key:s,value:s.id},p(s.nama),9,ye))),128))],544),[[u,e(o).idArea]])]),t("div",ve,[Pe,r(t("select",{class:"form-select","onUpdate:modelValue":a[27]||(a[27]=s=>e(o).form.dropspot_id=s),disabled:e(o).idArea===""},[e(o).form.dropspot_id===""?(l(),d("option",De," Pilih Dropspot ")):m("",!0),(l(!0),d(_,null,b(e(o).isDropspot,s=>(l(),d("option",{key:s,value:s.id},p(s.nama),9,Ae))),128))],8,ke),[[u,e(o).form.dropspot_id]])]),t("div",Oe,[Ce,r(t("input",{type:"text","onUpdate:modelValue":a[28]||(a[28]=s=>e(o).form.harga=s),placeholder:"Masukkan harga armada ..",class:"form-control mt-2"},null,512),[[g,e(o).form.harga]])])]),t("div",Ee,[t("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:a[29]||(a[29]=(...s)=>e(o).setOpenEdit&&e(o).setOpenEdit(...s))}," Tutup "),e(n).user.role=="sysadmin"?(l(),d("button",{key:0,type:"button",class:"btn btn-sm btn-danger",onClick:a[30]||(a[30]=(...s)=>e(o).deleteData&&e(o).deleteData(...s))}," Hapus ")):m("",!0),e(n).user.role=="sysadmin"?(l(),d("button",Ue," Simpan ")):m("",!0)])],32)])])],2)):m("",!0),e(o).isOpenPendamping===!0?(l(),d("div",{key:3,class:k(["modal fade modal-lg",{show:e(o).isOpenPendamping}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[t("div",xe,[t("div",Ve,[t("div",we,[Se,t("button",{class:"btn-close",type:"button",onClick:a[32]||(a[32]=(...s)=>e(o).setOpenPendamping&&e(o).setOpenPendamping(...s))})]),t("form",null,[t("div",Te,[t("p",null,[Ne,v(p(e(o).data_pendamping?e(o).data_pendamping.nama_lengkap:"-"),1)]),t("p",null,[je,v(p(e(o).data_pendamping?e(o).data_pendamping.no_hp:"-"),1)]),e(o).data_pendamping.nama_lengkap?(l(),d("button",{key:0,type:"button",class:"btn btn-sm btn-danger",onClick:a[33]||(a[33]=s=>e(o).deletePendamping())}," HAPUS PENDAMPING ")):m("",!0)]),t("div",Fe,[r(t("input",{type:"text","onUpdate:modelValue":a[34]||(a[34]=s=>e(n).paramsPendamping.cari=s),class:"form-control mb-2",placeholder:"Cari Pendamping ...",onKeyup:a[35]||(a[35]=(...s)=>e(n).getPendamping&&e(n).getPendamping(...s))},null,544),[[g,e(n).paramsPendamping.cari]]),t("div",Me,[t("table",$e,[Be,t("tbody",null,[(l(!0),d(_,null,b(e(n).itemsPendamping,(s,y)=>(l(),d("tr",{key:y},[t("td",null,p(y+1),1),t("td",null,p(s.nama_lengkap),1),t("td",null,[t("button",{type:"button",class:"btn btn-primary btn-sm",onClick:C=>e(o).setPendamping(s.uuid)}," Pilih ",8,He)])]))),128))])])])]),t("div",Le,[t("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:a[36]||(a[36]=(...s)=>e(o).setOpenPendamping&&e(o).setOpenPendamping(...s))}," Tutup ")])])])])],2)):m("",!0)],64)}}};export{Ke as default};
