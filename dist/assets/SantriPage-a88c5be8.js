import{x as k,C as c,S as P,a as g,g as n,c as r,b as t,d as m,E as p,u as e,F as _,s as h,t as d,v as u,e as v,z as b,n as f,l as O,q as S,m as C,w as L}from"./index-e66b72c4.js";const D=k("table_santri",{state:()=>({isOpenDetail:!1,items:[],item:{},fotoDiri:"",meta:{},myPage:"",filter:{wilayah:[],blok:[]},uuid:"",params:{cari:"",wilayah:"",blok:"",status_kepulangan:"",jenis_kelamin:"",page:1,limit:25}}),actions:{nexPage(l){this.params.page=parseInt(l)+1,this.getData()},prevPage(l){this.params.page=parseInt(l)-1,this.getData()},setPage(l){this.params.page=parseInt(l),this.getData()},searchPage(){this.params.page=1,this.getData()},async getData(){const l={params:this.params};try{await c.get("santri",l).then(a=>{(a.data.code=200)&&(this.items=a.data.data,this.meta=a.headers)})}catch{}},async handleDoubelClick(l){this.uuid=l;try{this.isOpenDetail=!0,await c.get("santri/"+l).then(a=>{(a.data.code=200)&&(this.item=a.data.data,this.getImage(a.data.data.niup,"medium"))})}catch{}},async getImage(l){try{const a={responseType:"blob"};await c.get("santri/image/"+l,a).then(i=>{this.fotoDiri=URL.createObjectURL(i.data)})}catch{}},async getWilayah(){try{await c.get("santri/filter/wilayah").then(l=>{(l.data.code=200)&&(this.filter.wilayah=l.data)})}catch{}},async getBlok(){this.params.blok="",this.getData();try{await c.get(`santri/filter/blok?alias_wilayah=${this.params.wilayah}`).then(l=>{(l.data.code=200)&&(this.filter.blok=l.data)})}catch{}}}}),U=k("form_santri",{state:()=>({isOpenEdit:!1,idArea:"",isArea:[],isDropspot:[],formEditDropspot:{dropspot_id:""}}),actions:{setOpenEdit(){this.isOpenEdit=!this.isOpenEdit},getArea(){try{c.get("area").then(l=>{this.isArea=l.data.data})}catch{}},async getDropspot(){this.formEditDropspot.dropspot_id="";const l={params:{area:this.idArea}};try{await c.get("dropspot",l).then(a=>{this.isDropspot=a.data.data})}catch{}},async editData(){const l=D();try{await c.post(`santri/daftar/${l.uuid}`,this.formEditDropspot).then(a=>{this.isOpenEdit=!1,this.formEditDropspot.dropspot_id="",this.idArea="",l.uuid="",l.isOpenDetail=!1,l.getData()})}catch(a){P.fire(a.response.data.message,a.response.data.error,"error")}}}}),V=t("h3",{class:"titlePage"},"Data Santri",-1),A=t("hr",null,null,-1),N={class:"filter-box mb-5 pb-3 row"},K={class:"col-md-2"},T=t("option",{value:"",selected:""},"Semua Wilayah",-1),B=["value"],$=["disabled"],I=t("option",{value:"",selected:""},"Semua Daerah",-1),R=["value"],j={class:"col-md-2"},F=t("option",{value:"",selected:""},"Semua Status Kepulangan",-1),W=t("option",{value:"rombongan"},"Rombongan",-1),z=t("option",{value:"non-rombongan"},"Non Rombongan",-1),M=[F,W,z],J=t("option",{value:"",selected:""},"Semua Jenis Kelamin",-1),q=t("option",{value:"L"},"Laki-Laki",-1),G=t("option",{value:"P"},"Perempuan",-1),H=[J,q,G],Q={class:"serach-box row"},X={class:"col-md-10 d-flex align-items-center mb-2"},Y={class:"col-md-2 d-flex align-items-center"},Z=t("hr",null,null,-1),tt={class:"table-responsive"},at={class:"table table-sm table-hover mt-3"},et=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"No"),t("th",{scope:"col"},"NIUP"),t("th",{scope:"col"},"Nama Lengkap"),t("th",{scope:"col"},"JK"),t("th",{scope:"col"},"Wilayah"),t("th",{scope:"col"},"Daerah"),t("th",{scope:"col"},"Kab/Kota"),t("th",{scope:"col"},"Status Kepulangan")])],-1),st=["onDblclick"],ot={class:"text-capitalize"},lt={class:"modal-dialog"},it={class:"modal-content"},nt={class:"modal-header"},rt=t("h1",{class:"modal-title fs-5",id:"modalDetailLabel"}," Detail Santri ",-1),dt={class:"modal-body"},mt={class:"alert alert-secondary p-1 fs-6",role:"alert"},ct={class:"row"},pt={class:"col-md-8 order-sm-2 order-md-2"},ut={class:"mb-3 row"},_t=t("label",{class:"col-sm-4 col-form-label"},"NIUP",-1),ht={class:"col-sm-8"},bt={class:"mb-3 row"},gt=t("label",{class:"col-sm-4 col-form-label"},"Nama Lengkap",-1),yt={class:"col-sm-8"},vt={class:"mb-3 row"},ft=t("label",{class:"col-sm-4 col-form-label"},"Tanggal Lahir",-1),kt={class:"col-sm-8"},Dt=["value"],wt={class:"mb-3 row"},xt=t("label",{class:"col-sm-4 col-form-label"},"Wilayah",-1),Et={class:"col-sm-8"},Pt={class:"mb-3 row"},Ot=t("label",{class:"col-sm-4 col-form-label"},"Daerah",-1),St={class:"col-sm-8"},Ct={class:"mb-3 row"},Lt=t("label",{class:"col-sm-4 col-form-label"},"Kamar",-1),Ut={class:"col-sm-8"},Vt={class:"mb-3 row"},At=t("label",{class:"col-sm-4 col-form-label"},"Kecamatan",-1),Nt={class:"col-sm-8"},Kt=["value"],Tt={class:"mb-3 row"},Bt=t("label",{class:"col-sm-4 col-form-label"},"Kabupaten",-1),$t={class:"col-sm-8"},It=["value"],Rt={class:"mb-3 row"},jt=t("label",{class:"col-sm-4 col-form-label"},"Provinsi",-1),Ft={class:"col-sm-8"},Wt=["value"],zt={class:"col-md-4 order-sm-1 order-md-2 mb-5 text-end"},Mt=["src"],Jt={class:"modal-footer"},qt={class:"modal-dialog"},Gt={class:"modal-content"},Ht={class:"modal-header"},Qt=t("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit Dropsot",-1),Xt={class:"modal-body"},Yt={class:"form-group mb-3"},Zt=t("small",null,"Area",-1),ta=t("option",{value:"",selected:""},"Pilih Area",-1),aa=["value"],ea={class:"form-group mb-3"},sa=t("small",null,"Dropspot",-1),oa=["disabled"],la={key:0,value:"",selected:""},ia=["value"],na={class:"modal-footer"},ra=t("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),pa={__name:"SantriPage",setup(l){const a=D(),i=U();return i.getArea(),a.getData(),a.getWilayah(),(da,o)=>{const w=g("app-paginate"),x=g("font-awesome-icon"),E=g("router-link");return n(),r("div",null,[V,A,t("div",N,[t("div",K,[m(t("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[0]||(o[0]=s=>e(a).params.wilayah=s),onChange:o[1]||(o[1]=(...s)=>e(a).getBlok&&e(a).getBlok(...s))},[T,(n(!0),r(_,null,h(e(a).filter.wilayah,s=>(n(),r("option",{key:s,value:s.alias_wilayah},d(s.wilayah),9,B))),128))],544),[[p,e(a).params.wilayah]]),m(t("select",{class:"form-select form-select-sm mb-2",disabled:e(a).params.wilayah==="","onUpdate:modelValue":o[2]||(o[2]=s=>e(a).params.blok=s),onChange:o[3]||(o[3]=(...s)=>e(a).getData&&e(a).getData(...s))},[I,(n(!0),r(_,null,h(e(a).filter.blok,s=>(n(),r("option",{key:s,value:s.id_blok},d(s.blok),9,R))),128))],40,$),[[p,e(a).params.blok]])]),t("div",j,[m(t("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[4]||(o[4]=s=>e(a).params.status_kepulangan=s),onChange:o[5]||(o[5]=(...s)=>e(a).getData&&e(a).getData(...s))},M,544),[[p,e(a).params.status_kepulangan]]),m(t("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[6]||(o[6]=s=>e(a).params.jenis_kelamin=s),onChange:o[7]||(o[7]=(...s)=>e(a).getData&&e(a).getData(...s))},H,544),[[p,e(a).params.jenis_kelamin]])]),t("div",Q,[t("div",X,[t("small",null,"Total data "+d(e(a).meta.x_total_data),1)]),t("div",Y,[m(t("input",{type:"text","onUpdate:modelValue":[o[8]||(o[8]=s=>e(a).params.cari=s),o[9]||(o[9]=(...s)=>e(a).searchPage&&e(a).searchPage(...s))],class:"form-control form-control-sm mb-2",placeholder:"Cari Santri ..."},null,512),[[u,e(a).params.cari]])])]),Z,t("div",tt,[t("table",at,[et,t("tbody",null,[(n(!0),r(_,null,h(e(a).items,(s,y)=>(n(),r("tr",{style:{cursor:"pointer"},key:y,onDblclick:ma=>e(a).handleDoubelClick(s.uuid)},[t("td",null,d(y+1+(e(a).params.page-1)*e(a).params.limit),1),t("td",null,d(s.niup),1),t("td",null,d(s.nama_lengkap),1),t("td",null,d(s.jenis_kelamin),1),t("td",null,d(s.wilayah?s.wilayah:"-"),1),t("td",null,d(s.blok?s.blok:"-"),1),t("td",null,d(s.kabupaten),1),t("td",ot,[t("i",null,d(s.status_kepulangan),1)])],40,st))),128))])])]),e(a).meta.x_total_data?(n(),v(w,{key:0,meta:e(a).meta,per_page:e(a).params.limit,onSetPage:o[10]||(o[10]=s=>e(a).setPage(s)),onNext:e(a).nexPage,onPrev:e(a).prevPage,onLast:e(a).setPage,onFirst:e(a).setPage},null,8,["meta","per_page","onNext","onPrev","onLast","onFirst"])):b("",!0),e(a).isOpenDetail===!0?(n(),r("div",{key:1,class:f(["modal fade modal-lg",{show:e(a).isOpenDetail}]),style:{display:"block"},id:"modalDetail",tabindex:"-1","aria-labelledby":"modalDetailLabel","aria-hidden":"true"},[t("div",lt,[t("div",it,[t("div",nt,[rt,t("button",{class:"btn-close",type:"button",onClick:o[11]||(o[11]=s=>e(a).isOpenDetail=!1)})]),t("div",dt,[t("p",mt,[t("i",null,[O(x,{icon:"bell",class:"icon"}),S(" Data santri hanya bersifat temporary sebagai kebutuhan Pulang Bersama, untuk data lebih detail silahkan lihat di Aplikasi PEDATREN")])]),t("div",ct,[t("div",pt,[t("div",ut,[_t,t("div",ht,[m(t("input",{type:"text",readonly:"",class:"form-control-plaintext","onUpdate:modelValue":o[12]||(o[12]=s=>e(a).item.niup=s)},null,512),[[u,e(a).item.niup]])])]),t("div",bt,[gt,t("div",yt,[m(t("input",{type:"text",readonly:"",class:"form-control-plaintext","onUpdate:modelValue":o[13]||(o[13]=s=>e(a).item.nama_lengkap=s)},null,512),[[u,e(a).item.nama_lengkap]])])]),t("div",vt,[ft,t("div",kt,[t("input",{type:"text",readonly:"",class:"form-control-plaintext",value:e(a).item.raw?e(a).item.raw.tempat_lahir+", "+e(a).item.raw.tanggal_lahir:""},null,8,Dt)])]),t("div",wt,[xt,t("div",Et,[m(t("input",{type:"text",readonly:"",class:"form-control-plaintext","onUpdate:modelValue":o[14]||(o[14]=s=>e(a).item.wilayah=s)},null,512),[[u,e(a).item.wilayah]])])]),t("div",Pt,[Ot,t("div",St,[m(t("input",{type:"text",readonly:"",class:"form-control-plaintext","onUpdate:modelValue":o[15]||(o[15]=s=>e(a).item.blok=s)},null,512),[[u,e(a).item.blok]])])]),t("div",Ct,[Lt,t("div",Ut,[m(t("input",{type:"text",readonly:"",class:"form-control-plaintext","onUpdate:modelValue":o[16]||(o[16]=s=>e(a).item.raw.domisili_santri[e(a).item.raw.domisili_santri.length-1].kamar=s)},null,512),[[u,e(a).item.raw.domisili_santri[e(a).item.raw.domisili_santri.length-1].kamar]])])]),t("div",Vt,[At,t("div",Nt,[t("input",{type:"text",readonly:"",class:"form-control-plaintext",value:e(a).item.kecamatan},null,8,Kt)])]),t("div",Tt,[Bt,t("div",$t,[t("input",{type:"text",readonly:"",class:"form-control-plaintext",value:e(a).item.kabupaten},null,8,It)])]),t("div",Rt,[jt,t("div",Ft,[t("input",{type:"text",readonly:"",class:"form-control-plaintext",value:e(a).item.provinsi},null,8,Wt)])])]),t("div",zt,[t("img",{src:e(a).fotoDiri,alt:"foto-diri",class:"img-thumbnail"},null,8,Mt)])])]),t("div",Jt,[e(a).item.status_kepulangan==="rombongan"?(n(),v(E,{key:0,to:{name:"penumpang-detail",params:{uuid:e(a).item.uuid}}},{default:C(()=>[t("button",{class:"btn btn-primary",type:"button",onClick:o[17]||(o[17]=s=>e(a).isOpenDetail=!1)},"Lihat Data Rombongan")]),_:1},8,["to"])):(n(),r("button",{key:1,class:"btn btn-primary",type:"button",onClick:o[18]||(o[18]=s=>e(i).isOpenEdit=!0)},"Daftarkan Rombongan")),t("button",{type:"button",class:"btn btn-secondary",onClick:o[19]||(o[19]=s=>e(a).isOpenDetail=!1)}," Tutup ")])])])],2)):b("",!0),e(i).isOpenEdit===!0?(n(),r("div",{key:2,class:f(["modal fade",{show:e(i).isOpenEdit}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[t("div",qt,[t("div",Gt,[t("div",Ht,[Qt,t("button",{class:"btn-close",type:"button",onClick:o[20]||(o[20]=(...s)=>e(i).setOpenEdit&&e(i).setOpenEdit(...s))})]),t("form",{onSubmit:o[25]||(o[25]=L(s=>e(i).editData(),["prevent"]))},[t("div",Xt,[t("div",Yt,[Zt,m(t("select",{class:"form-select","onUpdate:modelValue":o[21]||(o[21]=s=>e(i).idArea=s),onChange:o[22]||(o[22]=(...s)=>e(i).getDropspot&&e(i).getDropspot(...s))},[ta,(n(!0),r(_,null,h(e(i).isArea,s=>(n(),r("option",{key:s,value:s.id},d(s.nama),9,aa))),128))],544),[[p,e(i).idArea]])]),t("div",ea,[sa,m(t("select",{class:"form-select","onUpdate:modelValue":o[23]||(o[23]=s=>e(i).formEditDropspot.dropspot_id=s),disabled:e(i).idArea===""},[e(i).formEditDropspot.dropspot_id===""?(n(),r("option",la," Pilih Dropspot ")):b("",!0),(n(!0),r(_,null,h(e(i).isDropspot,s=>(n(),r("option",{key:s,value:s.id},d(s.nama),9,ia))),128))],8,oa),[[p,e(i).formEditDropspot.dropspot_id]])])]),t("div",na,[t("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:o[24]||(o[24]=(...s)=>e(i).setOpenEdit&&e(i).setOpenEdit(...s))}," Tutup "),ra])],32)])])],2)):b("",!0)])])}}};export{pa as default};
