import{C as D,I as h,L as x,y as O,a as C,o as n,c as r,b as a,d as m,Q as u,u as e,F as c,l as b,t as d,v as E,w as _,P as p,e as S,m as L,n as f,T as v}from"./index-a786a207.js";const y=D("table_penumpang",{state:()=>({items:[],meta:{},myPage:"",filter:{area:[],dropspot:[]},params:{cari:"",dropspot:"",area:"",pembayaran:"",page:1,limit:25}}),actions:{nexPage(l){this.params.page=parseInt(l)+1,this.getData()},prevPage(l){this.params.page=parseInt(l)-1,this.getData()},setPage(l){this.params.page=parseInt(l),this.getData()},searchPage(){this.params.page=1,this.getData()},async getData(){const l={params:this.params};try{await h.get("penumpang",l).then(s=>{(s.data.code=200)&&(this.totalData=s.headers.x_total_data,this.items=s.data.data,this.meta=s.headers,this.filter.area=s.data.filter.area)})}catch{}},async getDropspot(){this.params.dropspot="",this.getData();const l={params:{area:this.params.area}};try{await h.get("dropspot",l).then(s=>{(s.data.code=200)&&(this.filter.dropspot=s.data.data)})}catch{}}}}),w=D("form_penumpang",{state:()=>({contextMenuVisible:!1,contextMenuPosition:{x:0,y:0},isOpenEditDropspot:!1,isOpenEditPembayaran:!1,isArea:[],isDropspot:[],idEdit:"",idArea:"",dataEdit:{},formEditDropspot:{dropspot_id:""},formEditPembayaran:{jumlah_bayar:"",status_bayar:""}}),actions:{showContextMenu(l,s){l.preventDefault(),this.dataEdit=s,this.idEdit=s.id,this.contextMenuPosition={x:l.clientX,y:l.clientY},this.contextMenuVisible=!0,document.addEventListener("click",this.handleOutsideClick)},handleOutsideClick(l){this.contextMenuVisible=!1,document.removeEventListener("click",this.handleOutsideClick)},resetFormEditDropspot(){this.formEditDropspot.dropspot_id=""},resetFormEditPembayaran(){this.formEditPembayaran.jumlah_bayar="",this.formEditPembayaran.status_bayar=""},setOpenEditDropspot(){this.isOpenEditDropspot=!this.isOpenEditDropspot,this.resetFormEditDropspot()},setOpenEditPembayaran(){this.isOpenEditPembayaran=!this.isOpenEditPembayaran,this.resetFormEditPembayaran()},handleOpenEditDropspot(){this.idArea=this.dataEdit.dropspot.area_id,this.getArea(),this.getDropspot(),this.formEditDropspot.dropspot_id=this.dataEdit.dropspot_id,this.isOpenEditDropspot=!0},handleOpenEditPembayaran(){this.formEditPembayaran.status_bayar=this.dataEdit.status_bayar,this.formEditPembayaran.jumlah_bayar=this.dataEdit.jumlah_bayar,this.isOpenEditPembayaran=!0},goToDetail(){x.push(`penumpang/${this.dataEdit.santri_uuid}/detail`)},getArea(){try{h.get("area").then(l=>{this.isArea=l.data.data})}catch{}},async getDropspot(){this.formEditDropspot.dropspot_id="";const l={params:{area:this.idArea}};try{await h.get("dropspot",l).then(s=>{this.isDropspot=s.data.data})}catch{}},async editDropspot(){try{await h.put(`penumpang/dropspot/${this.idEdit}`,this.formEditDropspot).then(l=>{this.isOpenEditDropspot=!1,this.resetFormEditDropspot(),y().getData()})}catch{}},async editPembayaran(){try{await h.put(`penumpang/pembayaran/${this.idEdit}`,this.formEditPembayaran).then(l=>{this.isOpenEditPembayaran=!1,this.resetFormEditPembayaran(),y().getData()})}catch{}}}});const A=a("h3",null,"Data Penumpang",-1),V=a("hr",null,null,-1),M={class:"filter-box mb-5 row"},F={class:"col-md-2"},U=a("option",{value:"",selected:""},"Semua Area",-1),T=["value"],N=["disabled"],j=a("option",{value:"",selected:""},"Semua Dropsot",-1),B=["value"],I={class:"col-md-2"},K=v('<option value="" selected>Semua Status Pembayaran</option><option value="belum-lunas">Belum Lunas</option><option value="lunas">Lunas</option><option value="kurang">Kurang</option><option value="lebih">Lebih</option>',5),$=[K],R={class:"serach-box row"},z={class:"col-md-10 d-flex align-items-center mb-2"},J={class:"col-md-2 d-flex align-items-center"},Q=a("hr",null,null,-1),W={class:"table-responsive"},X={class:"table table-sm table-hover mt-3"},Y=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"No"),a("th",{scope:"col"},"NIUP"),a("th",{scope:"col"},"Nama Santri"),a("th",{scope:"col"},"Dropsot"),a("th",{scope:"col"},"Area"),a("th",{scope:"col"},"Tarif"),a("th",{scope:"col"},"Jumlah Bayar"),a("th",{scope:"col"},"Status Pembayaran"),a("th",{scope:"col"},"Wilayah"),a("th",{scope:"col"},"Daerah"),a("th",{scope:"col"},"Kecamatan"),a("th",{scope:"col"},"Kabupaten"),a("th",{scope:"col"},"Provinsi")])],-1),q=["onContextmenu"],G={key:0},H={key:1,class:"text-danger"},Z=a("i",null,"belum-ditentukan",-1),tt=[Z],at={key:2},et={key:3,class:"text-danger"},st=a("i",null,"belum-ditentukan",-1),ot=[st],it={key:4},nt={key:5,class:"text-danger"},rt={key:0,class:"badge bg-danger"},lt={key:1,class:"badge bg-success"},dt={key:2,class:"badge bg-warning"},pt={key:3,class:"badge bg-info"},mt={key:0},ut={class:"list-group list-group-flush"},ct={class:"modal-dialog"},ht={class:"modal-content"},bt={class:"modal-header"},_t=a("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit Dropsot",-1),yt={class:"modal-body"},gt={class:"form-group mb-3"},Et=a("small",null,"Area",-1),ft=a("option",{value:"",selected:""},"Pilih Area",-1),Dt=["value"],vt={class:"form-group mb-3"},Pt=a("small",null,"Dropspot",-1),kt=["disabled"],xt={key:0,value:"",selected:""},Ot=["value"],Ct={class:"modal-footer"},St=a("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),Lt={class:"modal-dialog"},wt={class:"modal-content"},At={class:"modal-header"},Vt=a("h1",{class:"modal-title fs-5",id:"modalEditLabel"},"Edit Pembayaran",-1),Mt={class:"modal-body"},Ft={class:"form-group mb-3"},Ut=a("small",null,"Jumlah Pembayaran",-1),Tt={class:"form-group mb-3"},Nt=a("small",null,"Status Pembayaran",-1),jt=v('<option value="" selected>Pilih Status</option><option value="lunas" selected>Lunas</option><option value="belum-lunas" selected>Belum Lunas</option><option value="lebih" selected>Lebih</option><option value="kurang" selected>Kurang</option>',5),Bt=[jt],It={class:"modal-footer"},Kt=a("button",{type:"submit",class:"btn btn-sm btn-primary"},"Simpan",-1),zt={__name:"PenumpangPage",setup(l){const s=y(),i=w();return O(()=>{s.getData()}),($t,o)=>{const P=C("app-paginate");return n(),r(c,null,[A,V,a("div",M,[a("div",F,[m(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[0]||(o[0]=t=>e(s).params.area=t),onChange:o[1]||(o[1]=(...t)=>e(s).getDropspot&&e(s).getDropspot(...t))},[U,(n(!0),r(c,null,b(e(s).filter.area,t=>(n(),r("option",{key:t,value:t.id},d(t.nama),9,T))),128))],544),[[u,e(s).params.area]]),m(a("select",{class:"form-select form-select-sm mb-2",disabled:e(s).params.area==="","onUpdate:modelValue":o[2]||(o[2]=t=>e(s).params.dropspot=t),onChange:o[3]||(o[3]=(...t)=>e(s).getData&&e(s).getData(...t))},[j,(n(!0),r(c,null,b(e(s).filter.dropspot,t=>(n(),r("option",{key:t,value:t.id},d(t.nama),9,B))),128))],40,N),[[u,e(s).params.dropspot]])]),a("div",I,[m(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":o[4]||(o[4]=t=>e(s).params.pembayaran=t),onChange:o[5]||(o[5]=(...t)=>e(s).getData&&e(s).getData(...t))},$,544),[[u,e(s).params.pembayaran]])])]),a("div",R,[a("div",z,[a("small",null,"Total data "+d(e(s).totalData),1)]),a("div",J,[m(a("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=t=>e(s).params.cari=t),class:"form-control form-control-sm mb-2",placeholder:"Cari Penumpang ...",onKeyup:o[7]||(o[7]=(...t)=>e(s).getData&&e(s).getData(...t))},null,544),[[E,e(s).params.cari]])])]),Q,a("div",W,[a("table",X,[Y,a("tbody",null,[(n(!0),r(c,null,b(e(s).items,(t,g)=>(n(),r("tr",{key:g,onContextmenu:_(k=>e(i).showContextMenu(k,t),["prevent"])},[a("td",null,d(g+1+(e(s).params.page-1)*e(s).params.limit),1),a("td",null,d(t.santri.niup),1),a("td",null,d(t.santri.nama_lengkap),1),t.dropspot?(n(),r("td",G,d(t.dropspot.nama),1)):(n(),r("td",H,tt)),t.dropspot?(n(),r("td",at,d(t.dropspot.area.nama),1)):(n(),r("td",et,ot)),t.dropspot?(n(),r("td",it,d("Rp. "+t.dropspot.harga),1)):(n(),r("td",nt,"Rp. 0")),a("td",null,d("Rp. "+t.jumlah_bayar),1),a("td",null,[t.status_bayar==="belum-lunas"?(n(),r("i",rt,d(t.status_bayar),1)):p("",!0),t.status_bayar==="lunas"?(n(),r("i",lt,d(t.status_bayar),1)):p("",!0),t.status_bayar==="kurang"?(n(),r("i",dt,d(t.status_bayar),1)):p("",!0),t.status_bayar==="lebih"?(n(),r("i",pt,d(t.status_bayar),1)):p("",!0)]),a("td",null,d(t.santri.wilayah),1),a("td",null,d(t.santri.blok),1),a("td",null,d(t.santri.kecamatan),1),a("td",null,d(t.santri.kabupaten),1),a("td",null,d(t.santri.provinsi),1)],40,q))),128))])])]),e(s).items.length>0?(n(),r("div",mt,[e(s).meta.x_total_data?(n(),S(P,{key:0,meta:e(s).meta,per_page:e(s).params.limit,onSetPage:o[8]||(o[8]=t=>e(s).setPage(t)),onNext:e(s).nexPage,onPrev:e(s).prevPage,onLast:e(s).setPage,onFirst:e(s).setPage},null,8,["meta","per_page","onNext","onPrev","onLast","onFirst"])):p("",!0)])):p("",!0),e(i).contextMenuVisible?(n(),r("div",{key:1,class:"context-menu",style:L({top:`${e(i).contextMenuPosition.y}px`,left:`${e(i).contextMenuPosition.x}px`})},[a("ul",ut,[a("li",{class:"list-group-item px-5",onClick:o[9]||(o[9]=(...t)=>e(i).handleOpenEditDropspot&&e(i).handleOpenEditDropspot(...t))}," Ubah Dropsot "),a("li",{class:"list-group-item px-5",onClick:o[10]||(o[10]=(...t)=>e(i).handleOpenEditPembayaran&&e(i).handleOpenEditPembayaran(...t))}," Ubah Status Pembayaran "),a("li",{class:"list-group-item px-5",onClick:o[11]||(o[11]=(...t)=>e(i).goToDetail&&e(i).goToDetail(...t))}," Lihat Detail Rombongan ")])],4)):p("",!0),e(i).isOpenEditDropspot===!0?(n(),r("div",{key:2,class:f(["modal fade",{show:e(i).isOpenEditDropspot}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[a("div",ct,[a("div",ht,[a("div",bt,[_t,a("button",{class:"btn-close",type:"button",onClick:o[12]||(o[12]=(...t)=>e(i).setOpenEditDropspot&&e(i).setOpenEditDropspot(...t))})]),a("form",{onSubmit:o[17]||(o[17]=_((...t)=>e(i).editDropspot&&e(i).editDropspot(...t),["prevent"]))},[a("div",yt,[a("div",gt,[Et,m(a("select",{class:"form-select","onUpdate:modelValue":o[13]||(o[13]=t=>e(i).idArea=t),onChange:o[14]||(o[14]=(...t)=>e(i).getDropspot&&e(i).getDropspot(...t))},[ft,(n(!0),r(c,null,b(e(i).isArea,t=>(n(),r("option",{key:t,value:t.id},d(t.nama),9,Dt))),128))],544),[[u,e(i).idArea]])]),a("div",vt,[Pt,m(a("select",{class:"form-select","onUpdate:modelValue":o[15]||(o[15]=t=>e(i).formEditDropspot.dropspot_id=t),disabled:e(i).idArea===""},[e(i).formEditDropspot.dropspot_id===""?(n(),r("option",xt," Pilih Dropspot ")):p("",!0),(n(!0),r(c,null,b(e(i).isDropspot,t=>(n(),r("option",{key:t,value:t.id},d(t.nama),9,Ot))),128))],8,kt),[[u,e(i).formEditDropspot.dropspot_id]])])]),a("div",Ct,[a("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:o[16]||(o[16]=(...t)=>e(i).setOpenEditDropspot&&e(i).setOpenEditDropspot(...t))}," Tutup "),St])],32)])])],2)):p("",!0),e(i).isOpenEditPembayaran===!0?(n(),r("div",{key:3,class:f(["modal fade",{show:e(i).isOpenEditPembayaran}]),style:{display:"block"},id:"modalEdit",tabindex:"-1","aria-labelledby":"modalEditLabel","aria-hidden":"true"},[a("div",Lt,[a("div",wt,[a("div",At,[Vt,a("button",{class:"btn-close",type:"button",onClick:o[18]||(o[18]=(...t)=>e(i).setOpenEditPembayaran&&e(i).setOpenEditPembayaran(...t))})]),a("form",{onSubmit:o[22]||(o[22]=_((...t)=>e(i).editPembayaran&&e(i).editPembayaran(...t),["prevent"]))},[a("div",Mt,[a("div",Ft,[Ut,m(a("input",{type:"number",class:"form-control mt-2","onUpdate:modelValue":o[19]||(o[19]=t=>e(i).formEditPembayaran.jumlah_bayar=t)},null,512),[[E,e(i).formEditPembayaran.jumlah_bayar]])]),a("div",Tt,[Nt,m(a("select",{class:"form-select","onUpdate:modelValue":o[20]||(o[20]=t=>e(i).formEditPembayaran.status_bayar=t)},Bt,512),[[u,e(i).formEditPembayaran.status_bayar]])])]),a("div",It,[a("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:o[21]||(o[21]=(...t)=>e(i).setOpenEditPembayaran&&e(i).setOpenEditPembayaran(...t))}," Tutup "),Kt])],32)])])],2)):p("",!0)],64)}}};export{zt as default};
