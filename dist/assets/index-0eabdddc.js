import{m as u,q as n,s as o,x as s,y as l,z as r,A as h,B as c,C as f,D as i,E as m}from"./index-dfcff93d.js";const p=u("auth",{state:()=>({token:localStorage.getItem("token")?n():null,user:localStorage.getItem("user")?o():null,nama:localStorage.getItem("nama")?s():null,foto:"photo",loading:!1,alert:!1}),getters:{isAuth(t){return t.token!==null||t.token!==void 0},getToken:()=>n(),useGetter:()=>o()!==null||o()!==void 0,getNamaLengkap:()=>s()!==null||s()!==void 0,getFotoProfil:()=>l()!==null||l()!==void 0},actions:{async login(t){this.loading=!0;try{await r.post("login",t).then(e=>{h(e.data.token),c(e.data.data),f(e.data.santri.nama_lengkap);const a=n(),g=o(),d=s();a?(this.alert=!0,this.SET_TOKEN_USER(a,g,d),this.loading=!1):(this.loading=!1,i.push("/login"))})}catch(e){console.log("error",e),this.loading=!1}},async getImage(t){this.loading=!0;try{const e={responseType:"blob"};await r.get("santri/image/"+t,e).then(a=>{this.foto=URL.createObjectURL(a.data),this.loading=!1})}catch(e){console.log("error",e),this.loading=!1}},SET_TOKEN_USER(t,e,a){m(t),this.token=t,this.user=e,this.nama=a,i.push("/")}}});export{p as u};
