import{x as k,D as V,B as _,i as M,j as N,o as $,a as U,c as p,b as a,k as x,t as i,u as t,m as u,d as h,y as I,F as g,q as f,E as v,v as j,g as c,n as S,G as B}from"./index-b7bccb03.js";import{u as T}from"./index-9cfab5a0.js";const A=k("table_armada_detail",{state:()=>({user:localStorage.getItem("user")?V():null,armada:{},items:[],filter:{area:[],dropspot:[]},meta:{},params:{cari:"",armada:"n",area:"",dropspot:"",jenis_kelamin:"",limit:""}}),actions:{async getData(){const d={params:this.params};try{await _.get("penumpang",d).then(s=>{(s.data.code=200)&&(this.items=s.data.data,this.filter.area=s.data.filter.area,this.meta=s.headers)})}catch{}},async getDropspot(){this.params.dropspot="",this.getData();const d={params:{area:this.params.area}};try{await _.get("dropspot",d).then(s=>{(s.data.code=200)&&(this.filter.dropspot=s.data.data)})}catch{}},async getDataDetail(d){try{await _.get(`armada/${d}`).then(s=>{(s.data.code=200)&&(this.armada=s.data.data)})}catch{}}}}),K=k("form_armada_detail",{state:()=>({formAddArmada:{id_penumpang:[]},formDelArmada:{id_penumpang:[]},lastSelectedIndexAddArmada:null,lastSelectedIndexDelArmada:null}),actions:{handleRowClickAddArmada(d){const s=d;if(event.shiftKey&&this.lastSelectedIndexAddArmada!==null){const e=Math.min(d,this.lastSelectedIndexAddArmada),n=Math.max(d,this.lastSelectedIndexAddArmada);if(s===n)for(let r=e+1;r<=n;r++)this.addIdPenumpangAddArmada(r);else if(s===e)for(let r=e;r+1<=n;r++)this.addIdPenumpangAddArmada(r);else for(let r=e;r<=n;r++)this.addIdPenumpangAddArmada(r)}else this.addIdPenumpangAddArmada(d);this.lastSelectedIndexAddArmada=d},handleRowDelArmada(d){const s=d;if(event.shiftKey&&this.lastSelectedIndexDelArmada!==null){const e=Math.min(d,this.lastSelectedIndexDelArmada),n=Math.max(d,this.lastSelectedIndexDelArmada);if(s===n)for(let r=e+1;r<=n;r++)this.addIdPenumpangDelArmada(r);else if(s===e)for(let r=e;r+1<=n;r++)this.addIdPenumpangDelArmada(r);else for(let r=e;r<=n;r++)this.addIdPenumpangDelArmada(r)}else this.addIdPenumpangDelArmada(d);this.lastSelectedIndexDelArmada=d},addIdPenumpangAddArmada(d){const s=A(),e=this.formAddArmada.id_penumpang.indexOf(s.items[d].id);e===-1?this.formAddArmada.id_penumpang.push(s.items[d].id):this.formAddArmada.id_penumpang.splice(e,1)},addIdPenumpangDelArmada(d){const s=A(),e=this.formDelArmada.id_penumpang.indexOf(s.armada.penumpang[d].id);e===-1?this.formDelArmada.id_penumpang.push(s.armada.penumpang[d].id):this.formDelArmada.id_penumpang.splice(e,1)},dragStartAddArmada(d){const s=A();this.formAddArmada.id_penumpang.push(s.items[d].id)},allowDropAddArmada(d){d.preventDefault()},dropAddArmada(d,s){d.preventDefault(),this.hitAddArmada(this.formAddArmada,s),this.formAddArmada.id_penumpang=[]},dragStartDellArmada(d){const s=A();this.formDelArmada.id_penumpang.push(s.armada.penumpang[d].id)},allowDropDelArmada(d){d.preventDefault()},dropDelArmada(d,s){d.preventDefault(),this.hitDelArmada(this.formDelArmada,s),this.formDelArmada.id_penumpang=[]},moveArmadaAdd(d,s){const e=Object.values(d);this.formAddArmada.id_penumpang=e,this.hitAddArmada(this.formAddArmada,s),this.formAddArmada.id_penumpang=[]},moveArmadaDell(d,s){const e=Object.values(d);this.formDelArmada.id_penumpang=e,this.hitDelArmada(this.formDelArmada,s),this.formDelArmada.id_penumpang=[]},async hitAddArmada(d,s){try{await _.put(`penumpang/armada/${s}`,d).then(e=>{const n=A();n.getData(),n.getDataDetail(s)})}catch{}},async hitDelArmada(d,s){try{await _.put("penumpang/armada/delete",d).then(e=>{const n=A();n.getData(),n.getDataDetail(s)})}catch{}}}}),L=a("h3",{class:"titlePage"},"Pengelolaan Data Penumpang",-1),R=a("hr",null,null,-1),z={key:0,class:"row"},E={class:"col-md-6"},F={class:"row"},O={class:"col-md-2"},H={class:"col-md-10"},J=a("hr",null,null,-1),q={class:"mb-1"},G=a("b",null,"Dropspot : ",-1),W=a("p",{class:"mb-1"},[a("b",null,"Pendamping : "),u("-")],-1),Q=a("p",{class:"mb-1"},[a("b",null,"No. HP : "),u("-")],-1),X=a("hr",null,null,-1),Y={class:"mb-1"},Z=a("b",null,"Jumlah Penumpang : ",-1),aa=a("hr",null,null,-1),ea={class:"row"},ta={class:"col"},sa={class:"badge bg-success"},da={class:"col text-center"},oa={class:"table-responsive"},na=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"No"),a("th",{scope:"col"},"Nama"),a("th",{scope:"col"},"Dropspot")])],-1),la=["onDragstart","onClick"],ra={class:"col-md-6"},ia={class:"filter-box mb-5 row"},ma={class:"col-md-4"},pa=a("option",{value:"",selected:""},"Semua Area",-1),ca=["value"],ua=["disabled"],ha=a("option",{value:"",selected:""},"Semua Dropsot",-1),Aa=["value"],ga={class:"col-md-4"},_a=a("option",{value:"",selected:""},"Semua Jenis Kelamin",-1),Da=a("option",{value:"L",selected:""},"Laki-laki",-1),fa=a("option",{value:"P",selected:""},"Perempuan",-1),va=[_a,Da,fa],ba=B('<option value="" selected>Limit by Kapasitas</option><option value="60" selected>BUS (60)</option><option value="34" selected>Mini Bus (34)</option><option value="18" selected>ELF (18)</option><option value="13" selected>HIACE (13)</option><option value="7" selected>MPV (8)</option>',6),ya=[ba],xa={class:"serach-box row"},wa={class:"col-md-8 d-flex align-items-center mb-2"},Ia={class:"col-md-4 d-flex align-items-center"},Sa=a("hr",null,null,-1),ka={class:"row"},Pa={class:"col"},Ca={class:"badge bg-success"},Va={class:"col text-center"},Ma={class:"table-responsive"},Na=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"No"),a("th",{scope:"col"},"Nama"),a("th",{scope:"col"},"Wilayah")])],-1),$a=["onDragstart","onClick"],Ua={key:1},Ta={__name:"DetailPage",setup(d){const s=T(),e=A(),n=K(),r=M(),w=N(()=>s.user?s.user.role:"wilayah"),P=D=>n.formAddArmada.id_penumpang.includes(e.items[D].id),C=D=>n.formDelArmada.id_penumpang.includes(e.armada.penumpang[D].id);return $(()=>{e.getData(),e.getDataDetail(r.params.id)}),(D,l)=>{const b=U("font-awesome-icon");return c(),p(g,null,[L,R,w.value==="sysadmin"||w.value==="admin"?(c(),p("div",z,[a("div",E,[a("div",F,[a("div",O,[x(b,{icon:"bus",class:"icon",style:{"font-size":"100px"}})]),a("div",H,[a("h3",null,i(t(e).armada.nama),1),J,a("p",q,[G,u(i(t(e).armada.dropspot?t(e).armada.dropspot.nama:"-"),1)]),W,Q,X,a("p",Y,[Z,u(i(t(e).armada.penumpang?t(e).armada.penumpang.length:0),1)])])]),aa,a("div",ea,[a("div",ta,[u(" Total "),a("p",sa,i(t(n).formDelArmada.id_penumpang.length),1),u(" item dipilih ")]),h(a("div",da,[x(b,{icon:"arrow-right",class:"icon badge bg-primary p-2",style:{cursor:"pointer","font-size":"medium"},onClick:l[0]||(l[0]=o=>t(n).moveArmadaDell(t(n).formDelArmada.id_penumpang,t(r).params.id))})],512),[[I,t(n).formDelArmada.id_penumpang?t(n).formDelArmada.id_penumpang.length>0:""]])]),a("div",oa,[a("table",{class:"table table-sm table-hover mt-3",onDragover:l[1]||(l[1]=(...o)=>t(n).allowDropAddArmada&&t(n).allowDropAddArmada(...o)),onDrop:l[2]||(l[2]=o=>t(n).dropAddArmada(o,t(r).params.id))},[na,a("tbody",null,[(c(!0),p(g,null,f(t(e).armada.penumpang,(o,m)=>(c(),p("tr",{key:m,draggable:"true",onDragstart:y=>t(n).dragStartDellArmada(m),onClick:y=>t(n).handleRowDelArmada(m),class:S({"table-active":C(m)})},[a("td",null,i(m+1),1),a("td",null,i(o.santri.nama_lengkap),1),a("td",null,i(o.dropspot?o.dropspot.nama:"-"),1)],42,la))),128))])],32)])]),a("div",ra,[a("div",ia,[a("div",ma,[h(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[3]||(l[3]=o=>t(e).params.area=o),onChange:l[4]||(l[4]=(...o)=>t(e).getDropspot&&t(e).getDropspot(...o))},[pa,(c(!0),p(g,null,f(t(e).filter.area,o=>(c(),p("option",{key:o,value:o.id},i(o.nama),9,ca))),128))],544),[[v,t(e).params.area]]),h(a("select",{class:"form-select form-select-sm mb-2",disabled:t(e).params.area==="","onUpdate:modelValue":l[5]||(l[5]=o=>t(e).params.dropspot=o),onChange:l[6]||(l[6]=(...o)=>t(e).getData&&t(e).getData(...o))},[ha,(c(!0),p(g,null,f(t(e).filter.dropspot,o=>(c(),p("option",{key:o,value:o.id},i(o.nama),9,Aa))),128))],40,ua),[[v,t(e).params.dropspot]])]),a("div",ga,[h(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[7]||(l[7]=o=>t(e).params.jenis_kelamin=o),onChange:l[8]||(l[8]=(...o)=>t(e).getData&&t(e).getData(...o))},va,544),[[v,t(e).params.jenis_kelamin]]),h(a("select",{class:"form-select form-select-sm mb-2","onUpdate:modelValue":l[9]||(l[9]=o=>t(e).params.limit=o),onChange:l[10]||(l[10]=(...o)=>t(e).getData&&t(e).getData(...o))},ya,544),[[v,t(e).params.limit]])])]),a("div",xa,[a("div",wa,[a("small",null,"Total data "+i(t(e).meta.x_total_data),1)]),a("div",Ia,[h(a("input",{type:"text","onUpdate:modelValue":l[11]||(l[11]=o=>t(e).params.cari=o),class:"form-control form-control-sm mb-2",placeholder:"Cari Santri ...",onKeyup:l[12]||(l[12]=(...o)=>t(e).getData&&t(e).getData(...o))},null,544),[[j,t(e).params.cari]])])]),Sa,a("div",ka,[a("div",Pa,[u(" Total "),a("p",Ca,i(t(n).formAddArmada.id_penumpang.length),1),u(" item dipilih ")]),h(a("div",Va,[x(b,{icon:"arrow-left",class:"icon badge bg-primary p-2",style:{cursor:"pointer","font-size":"medium"},onClick:l[13]||(l[13]=o=>t(n).moveArmadaAdd(t(n).formAddArmada.id_penumpang,t(r).params.id))})],512),[[I,t(n).formAddArmada.id_penumpang?t(n).formAddArmada.id_penumpang.length>0:""]])]),a("div",Ma,[a("table",{class:"table table-sm table-hover mt-3",onDragover:l[14]||(l[14]=(...o)=>t(n).allowDropDelArmada&&t(n).allowDropDelArmada(...o)),onDrop:l[15]||(l[15]=o=>t(n).dropDelArmada(o,t(r).params.id))},[Na,a("tbody",null,[(c(!0),p(g,null,f(t(e).items,(o,m)=>(c(),p("tr",{key:m,draggable:"true",onDragstart:y=>t(n).dragStartAddArmada(m),onClick:y=>t(n).handleRowClickAddArmada(m),class:S({"table-active":P(m)})},[a("td",null,i(m+1),1),a("td",null,i(o.santri.nama_lengkap),1),a("td",null,i(o.santri.wilayah),1)],42,$a))),128))])],32)])])])):(c(),p("div",Ua,"wilayah"))],64)}}};export{Ta as default};
